<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fluency Grid Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 30px;
      text-align: center;
    }
    h1 {
      font-size: 28px;
    }
    .section {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
    .section-box {
      border: 2px solid #000;
      padding: 20px;
      margin: 10px;
      min-width: 200px;
    }
    .section-box label {
      display: block;
      margin-bottom: 10px;
      text-align: left;
    }
    .section-box h3 {
      margin-bottom: 10px;
      text-align: center;
    }
    .generate-controls {
      margin-top: 30px;
    }
    .generate-controls button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
    }
    #gridContainer {
      margin-top: 30px;
    }
    table {
      margin: 0 auto;
      border-collapse: collapse;
    }
    td {
      border: 1px solid #000;
      width: 120px;
      height: 80px;
      font-size: 32px;
      text-align: center;
      vertical-align: middle;
    }
    .sentence-cell {
      font-size: 20px;
    }
    #copyright {
      margin-top: 30px;
      font-size: 12px;
    }
    @media print {
      .section, .generate-controls {
        display: none;
      }
    }
  </style>
</head>
<body>
  <h1>Fluency Grid Generator</h1>
  <div style="margin-top: 10px; font-size: 18px;">
    <strong>What would you like to generate?</strong><br>
    <label><input type="radio" name="displayMode" value="words"> Only Words</label>
    <label><input type="radio" name="displayMode" value="sentences"> Only Sentences</label>
    <label><input type="radio" name="displayMode" value="both"> Both</label>
  </div>

  <div class="section">
    <div class="section-box">
      <h3>Select Skill(s)</h3>
      <!-- Add one checkbox per skill -->
      <label><input type="checkbox" value="0.1"> 0.1 - Short A</label>
      <label><input type="checkbox" value="0.2"> 0.2 - Short O</label>
      <label><input type="checkbox" value="0.3"> 0.3 - Short I</label>
      <label><input type="checkbox" value="0.4"> 0.4 - Short U</label>
      <label><input type="checkbox" value="0.5"> 0.5 - Short E</label>
      <label><input type="checkbox" value="0.6"> 0.6 - FLSZ</label>
      <label><input type="checkbox" value="0.7"> 0.7 - CVC and FLSZ</label>
      <label><input type="checkbox" value="Mixed CVC"> Mixed CVC</label>
    </div>

    <div class="section-box">
      <h3>Grid Size</h3>
      <label><input type="radio" name="gridSize" value="3"> 3x5 (15 words)</label>
      <label><input type="radio" name="gridSize" value="4"> 4x5 (20 words)</label>
      <label><input type="radio" name="gridSize" value="5"> 5x5 (25 words)</label>

      <h3 style="margin-top: 20px;">Tricky-Sticky Words:</h3>
      <label><input type="checkbox" id="includeTricky"> Yes, Include Them</label>
    </div>
  </div>

  <div class="generate-controls">
    <button onclick="generateGrid()">Generate Grid</button>
    <button onclick="window.print()">Print</button>
  </div>

  <div id="gridContainer"></div>
  <div id="copyright">Copyright - InterventionStation.com - @TeachwithMrC</div>

  <script>
    // This is where the fluencyDataFull.js data would be pasted directly
    // (let me know if you want me to do that now)
  </script>

  <script>
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function generateGrid() {
      // Grid size
      const gridSize = parseInt(document.querySelector('input[name="gridSize"]:checked')?.value);
      if (!gridSize) return alert("Please select a grid size.");

      // Display mode
      const displayMode = document.querySelector('input[name="displayMode"]:checked')?.value;
      if (!displayMode) return alert("Please select what to generate (words/sentences/both).”);

      // Selected skills
      const checkedSkills = [...document.querySelectorAll('.section-box input[type="checkbox"]:checked')]
        .map(cb => cb.value)
        .filter(val => !["yes", "on"].includes(val.toLowerCase()));

      if (checkedSkills.length === 0) return alert("Please select at least one skill.");

      // Pull data
      let pool = [];
      checkedSkills.forEach(skill => {
        if (displayMode !== "sentences") pool.push(...(fluencyData[skill] || []));
        if (displayMode !== "words") pool.push(...(sentenceData[skill] || []));
        if (document.getElementById("includeTricky").checked && trickyWords[skill]) {
          pool.push(...trickyWords[skill]);
        }
      });

      pool = shuffle([...new Set(pool)]); // deduplicate
      const totalCells = gridSize * 5;

      // Generate grid HTML
      let html = "<br>".repeat(gridSize === 3 ? 6 : gridSize === 4 ? 4 : 2);
      html += '<table>';
      for (let i = 0; i < 5; i++) {
        html += '<tr>';
        for (let j = 0; j < gridSize; j++) {
          const idx = i * gridSize + j;
          const word = pool[idx] || "";
          const isSentence = word.includes(" ");
          html += `<td class="${isSentence ? 'sentence-cell' : ''}">${word}</td>`;
        }
        html += '</tr>';
      }
      html += '</table>';
      html += "<br>".repeat(gridSize === 3 ? 6 : gridSize === 4 ? 4 : 2);

      document.getElementById("gridContainer").innerHTML = html;
    }
  </script>
</body>
</html>
