<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fluency Grid Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="fluencyDataFull_v2.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      text-align: center;
      margin: 40px;
    }
    #mainTable {
      margin: 0 auto;
      border-collapse: separate;
      border-spacing: 40px 0;
    }
    #controlsLeft, #controlsRight {
      vertical-align: top;
      padding: 10px;
      border: 2px solid #000;
      border-radius: 10px;
    }
    #gridSizeOptions {
      margin-top: 10px;
    }
    .center-buttons {
      margin-top: 20px;
    }
    table.gridTable {
      margin: 0 auto;
      border-collapse: collapse;
    }
    table.gridTable td {
      border: 1px solid #000;
      width: 120px;
      height: 80px;
      font-size: 32px;
      text-align: center;
      vertical-align: middle;
    }
    #footer {
      font-size: 12px;
      margin-top: 20px;
    }
    @media print {
      body * {
        visibility: hidden;
      }
      #gridContainer, #gridContainer * {
        visibility: visible;
      }
      #gridContainer {
        position: absolute;
        top: 0;
        left: 0;
      }
    }
  </style>
</head>
<body>

  <h1 style="font-size: 26px; margin-bottom: 10px;">Fluency Grid Generator</h1>
  <p style="font-size: 18px; font-weight: bold;">First, select what you'd like to generate:</p>

  <div class="center-buttons">
    <label><input type="radio" name="contentType" value="words"> Only Words</label>
    <label><input type="radio" name="contentType" value="sentences"> Only Sentences</label>
    <label><input type="radio" name="contentType" value="both"> Both</label>
  </div>

  <table id="mainTable">
    <tr>
      <td id="controlsLeft">
        <h3>Select Skill(s):</h3>
        <div id="skillCheckboxes"></div>
        <div id="gridSizeOptions">
          <h3>Grid Size:</h3>
          <label><input type="radio" name="gridSize" value="15"> 3 x 5 - 15 words</label><br>
          <label><input type="radio" name="gridSize" value="20"> 4 x 5 - 20 words</label><br>
          <label><input type="radio" name="gridSize" value="25"> 5 x 5 - 25 words</label><br>
        </div>
      </td>
      <td id="controlsRight">
        <h3>Tricky-Sticky Words:</h3>
        <label><input type="checkbox" id="includeSticky"> Yes, Include Them</label>
      </td>
    </tr>
  </table>

  <div class="center-buttons">
    <button onclick="generateGrid()">Generate Fluency Grid</button>
    <button onclick="window.print()">Print</button>
  </div>

  <h2 id="gridTitle" style="margin-top: 40px;"></h2>
  <div id="gridContainer"></div>

  <script>
    const stickyWords = {
      "0.1 - Short A": ["I", "a", "the"],
      "0.2 - Short O": ["is", "his", "has", "as"],
      "0.3 - Short i": ["to", "do"],
      "0.4 - Short U": ["was", "you"],
      "0.5 - Short E": ["he", "be", "we"],
      "0.6 - FLSZ": ["my", "try", "by", "why"],
      "0.7 - FLSZ and CVC": [],
      "Mixed CVC": ["I", "a", "the", "is", "his", "has", "as", "to", "do", "was", "you", "he", "be", "we", "my", "try", "by", "why"]
    };

    const skills = Object.keys(fluencyData.words);
    const skillCheckboxes = document.getElementById("skillCheckboxes");
    skills.forEach(skill => {
      const label = document.createElement("label");
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.value = skill;
      label.appendChild(checkbox);
      label.appendChild(document.createTextNode(" " + skill));
      skillCheckboxes.appendChild(label);
      skillCheckboxes.appendChild(document.createElement("br"));
    });

    function generateGrid() {
      const selectedSkills = [...document.querySelectorAll('#skillCheckboxes input:checked')].map(cb => cb.value);
      const contentType = document.querySelector('input[name="contentType"]:checked')?.value;
      const gridSize = parseInt(document.querySelector('input[name="gridSize"]:checked')?.value);
      const includeSticky = document.getElementById("includeSticky").checked;

      if (!selectedSkills.length || !contentType || !gridSize) {
        alert("Please select a content type, at least one skill, and a grid size.");
        return;
      }

      let pool = [];
      selectedSkills.forEach(skill => {
        if (contentType === "words" || contentType === "both") {
          pool.push(...fluencyData.words[skill]);
        }
        if (contentType === "sentences" || contentType === "both") {
          pool.push(...fluencyData.sentences[skill]);
        }
        if (includeSticky) {
          pool.push(...(stickyWords[skill] || []));
        }
      });

      // De-duplicate and shuffle
      pool = [...new Set(pool)].sort(() => 0.5 - Math.random());
      const selection = pool.slice(0, gridSize);

      const rows = gridSize / 5;
      let html = '<table class="gridTable">';
      for (let i = 0; i < rows; i++) {
        html += '<tr>';
        for (let j = 0; j < 5; j++) {
          const idx = i * 5 + j;
          html += `<td>${selection[idx] || ""}</td>`;
        }
        html += '</tr>';
      }
      html += '</table>';
      html += "<br><br>".repeat(gridSize === 15 ? 6 : gridSize === 20 ? 4 : 2);
      html += '<div id="footer">Copyright - InterventionStation.com - @TeachwithMrC</div>';

      document.getElementById("gridContainer").innerHTML = html;
    }
  </script>

</body>
</html>
