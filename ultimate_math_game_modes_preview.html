<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ultimate Math Game Modes Preview</title>
  <style>
    :root {
      --ink: #1b2b3d;
      --bg: #eef5ff;
      --card: #ffffff;
      --line: #cbdbef;
      --accent: #134b80;
      --x: #d73737;
      --o: #2570c1;
      --ok: #1f7f35;
      --bad: #a12424;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      background: radial-gradient(circle at 88% -10%, #ffffff 0%, #edf4ff 45%, #e7f0ff 100%);
      color: var(--ink);
      font-family: "Poppins", "Avenir Next", "Segoe UI", sans-serif;
      padding: 20px;
      user-select: none;
      -webkit-user-select: none;
    }

    .app {
      max-width: 1120px;
      margin: 0 auto;
    }

    h1 {
      margin: 0 0 6px;
      text-align: center;
      font-size: 1.95rem;
    }

    .subtitle {
      text-align: center;
      margin: 0 0 14px;
      color: #3c5672;
      font-weight: 600;
    }

    .preview-note {
      text-align: center;
      margin: 0 auto 14px;
      max-width: 960px;
      border: 2px solid #000;
      border-radius: 12px;
      background: #fff;
      padding: 10px 12px;
      font-weight: 700;
    }

    .mode-tabs {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 14px;
    }

    .mode-tab {
      border: 2px solid #000;
      border-radius: 12px;
      background: #fff;
      color: var(--ink);
      padding: 10px 8px;
      font: inherit;
      font-weight: 800;
      cursor: pointer;
      min-height: 58px;
    }

    .mode-tab.active {
      background: #111;
      color: #fff;
    }

    .panel {
      display: none;
      position: relative;
      background: var(--card);
      border: 2px solid #000;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 9px 20px rgba(28, 52, 84, 0.12);
    }

    .panel.active { display: block; }

    .panel h2 {
      margin: 0 0 10px;
      text-align: center;
      font-size: 1.35rem;
    }

    .meta {
      text-align: center;
      margin-bottom: 10px;
      color: #455e78;
      font-weight: 700;
      font-size: 0.95rem;
    }

    .lock-shell {
      position: relative;
      border: 2px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      min-height: 360px;
      background: linear-gradient(180deg, #fefeff, #f3f8ff);
      overflow: hidden;
    }

    .static-preview {
      pointer-events: none;
    }

    .overlay {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      background:
        linear-gradient(rgba(255, 255, 255, 0.66), rgba(255, 255, 255, 0.66)),
        repeating-linear-gradient(-35deg, rgba(24, 74, 125, 0.1) 0 12px, rgba(24, 74, 125, 0.03) 12px 24px);
      z-index: 5;
    }

    .overlay-card {
      border: 2px solid #000;
      border-radius: 12px;
      background: #111;
      color: #fff;
      padding: 14px 16px;
      text-align: center;
      max-width: 420px;
      font-weight: 700;
      line-height: 1.35;
    }

    .math-grid {
      margin: 0 auto;
      width: min(650px, 100%);
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .math-cell {
      border: 2px solid #1d2f43;
      border-radius: 10px;
      min-height: 92px;
      display: grid;
      place-items: center;
      font-size: clamp(1.15rem, 3.2vw, 1.65rem);
      font-weight: 800;
      background: #fff;
    }

    .connect-head {
      margin: 0 auto 8px;
      width: min(760px, 100%);
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 6px;
    }

    .drop-btn {
      border: 2px solid #6f87a0;
      border-radius: 10px;
      background: #eef5ff;
      font-weight: 800;
      padding: 6px 4px;
      color: #5f7388;
    }

    .connect-grid {
      margin: 0 auto;
      width: min(760px, 100%);
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 6px;
      padding: 8px;
      border: 2px solid #163f69;
      border-radius: 12px;
      background: #2f6fa8;
    }

    .slot {
      aspect-ratio: 1 / 1;
      border-radius: 999px;
      border: 2px solid #15426e;
      background: #fff;
    }

    .slot.red { background: #e53935; }
    .slot.yellow { background: #f2c900; }

    .roll-table {
      margin: 0 auto;
      width: min(760px, 100%);
      border-collapse: collapse;
      table-layout: fixed;
      background: #fff;
      border: 2px solid #000;
    }

    .roll-table th,
    .roll-table td {
      border: 1px solid #000;
      text-align: center;
      vertical-align: middle;
      padding: 8px 6px;
      font-weight: 800;
    }

    .roll-table th {
      background: #eef4ff;
      font-size: 0.95rem;
    }

    .roll-table td {
      height: 72px;
      font-size: clamp(1rem, 2.6vw, 1.2rem);
    }

    .demo-card {
      margin-top: 16px;
      background: var(--card);
      border: 2px solid #000;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 10px 20px rgba(18, 40, 70, 0.1);
    }

    .demo-card h3 {
      margin: 0 0 6px;
      text-align: center;
      font-size: 1.3rem;
    }

    .demo-sub {
      margin: 0 0 10px;
      text-align: center;
      color: #3f5a73;
      font-weight: 600;
    }

    .demo-status {
      text-align: center;
      font-weight: 700;
      margin: 0 0 10px;
      min-height: 1.4rem;
    }

    .demo-status.good { color: var(--ok); }
    .demo-status.bad { color: var(--bad); }

    .demo-grid {
      margin: 0 auto 10px;
      width: min(640px, 100%);
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .demo-cell {
      border: 2px solid #1b2f44;
      border-radius: 10px;
      background: #f8fbff;
      min-height: 108px;
      padding: 8px 8px 4px;
      display: grid;
      grid-template-rows: 1fr auto;
      gap: 4px;
      cursor: pointer;
    }

    .demo-cell.locked {
      opacity: 0.62;
      cursor: not-allowed;
    }

    .demo-prompt {
      font-size: clamp(0.95rem, 2.5vw, 1.15rem);
      font-weight: 800;
      text-align: center;
      display: grid;
      place-items: center;
    }

    .demo-mark {
      min-height: 36px;
      line-height: 36px;
      text-align: center;
      font-size: 2rem;
      font-weight: 900;
    }

    .demo-mark.x { color: var(--x); }
    .demo-mark.o { color: var(--o); }

    .demo-actions {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .demo-btn {
      border: 2px solid #000;
      border-radius: 10px;
      background: #fff;
      padding: 8px 12px;
      font: inherit;
      font-weight: 800;
      cursor: pointer;
    }

    .score {
      text-align: center;
      margin-bottom: 10px;
      font-weight: 700;
      color: #354f68;
    }

    .dialog {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(14, 25, 39, 0.45);
      z-index: 30;
      padding: 14px;
    }

    .dialog.open { display: flex; }

    .dialog-card {
      width: min(420px, 100%);
      border: 2px solid #000;
      border-radius: 12px;
      background: #fff;
      padding: 14px;
    }

    .dialog-title {
      margin: 0 0 8px;
      text-align: center;
      font-size: 1.1rem;
      font-weight: 800;
    }

    .dialog-problem {
      margin: 0 0 8px;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 800;
    }

    .dialog-input {
      width: 100%;
      border: 2px solid #1f3348;
      border-radius: 10px;
      padding: 10px;
      font: inherit;
      font-size: 1rem;
      text-align: center;
      margin-bottom: 8px;
    }

    .dialog-msg {
      min-height: 1.2rem;
      text-align: center;
      font-weight: 700;
      color: var(--bad);
      margin-bottom: 8px;
    }

    .dialog-actions {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    @media (max-width: 760px) {
      .mode-tabs {
        grid-template-columns: 1fr;
      }

      .lock-shell {
        min-height: 310px;
      }

      .overlay-card {
        max-width: 280px;
        font-size: 0.9rem;
      }

      .math-cell {
        min-height: 72px;
      }

      .demo-cell {
        min-height: 90px;
      }

      .roll-table td {
        height: 58px;
        font-size: 0.92rem;
      }
    }
  </style>
</head>
<body oncontextmenu="return false;">
  <main class="app">
    <h1>Math Game Modes Preview</h1>
    <p class="subtitle">Tic Tac Toe, 4 in a Row, and Roll and Read</p>
    <div class="preview-note">Preview is locked for mode layouts. One counting demo is playable below so families can try the game flow.</div>

    <div class="mode-tabs" id="modeTabs">
      <button type="button" class="mode-tab active" data-mode="ttt">Tic Tac Toe Preview</button>
      <button type="button" class="mode-tab" data-mode="connect4">4 in a Row Preview</button>
      <button type="button" class="mode-tab" data-mode="rollread">Roll and Read Preview</button>
    </div>

    <section class="panel active" data-panel="ttt">
      <h2>Math Tic Tac Toe</h2>
      <div class="meta">Static preview layout</div>
      <div class="lock-shell static-preview">
        <div class="math-grid" aria-hidden="true">
          <div class="math-cell">6 + 3</div>
          <div class="math-cell">14 - 5</div>
          <div class="math-cell">8 + 7</div>
          <div class="math-cell">9 - 2</div>
          <div class="math-cell">5 + 6</div>
          <div class="math-cell">13 - 4</div>
          <div class="math-cell">4 + 8</div>
          <div class="math-cell">12 - 7</div>
          <div class="math-cell">7 + 5</div>
        </div>
        <div class="overlay">
          <div class="overlay-card">Preview Mode: visual sample only. Interactive play is locked for this mode preview.</div>
        </div>
      </div>
    </section>

    <section class="panel" data-panel="connect4">
      <h2>Math 4 in a Row</h2>
      <div class="meta">Static preview layout</div>
      <div class="lock-shell static-preview">
        <div class="connect-head" aria-hidden="true">
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
          <button class="drop-btn" type="button">Drop</button>
        </div>
        <div class="connect-grid" aria-hidden="true">
          <div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
          <div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
          <div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
          <div class="slot"></div><div class="slot yellow"></div><div class="slot red"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
          <div class="slot"></div><div class="slot yellow"></div><div class="slot red"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
          <div class="slot yellow"></div><div class="slot yellow"></div><div class="slot red"></div><div class="slot red"></div><div class="slot"></div><div class="slot"></div><div class="slot"></div>
        </div>
        <div class="overlay">
          <div class="overlay-card">Preview Mode: this mode is display-only in preview.</div>
        </div>
      </div>
    </section>

    <section class="panel" data-panel="rollread">
      <h2>Math Roll and Read</h2>
      <div class="meta">Static preview layout</div>
      <div class="lock-shell static-preview">
        <table class="roll-table" aria-hidden="true">
          <thead>
            <tr>
              <th>Die 1</th>
              <th>Die 2</th>
              <th>Die 3</th>
              <th>Die 4</th>
              <th>Die 5</th>
              <th>Die 6</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>5 + 2</td><td>11 - 3</td><td>7 + 4</td><td>10 - 6</td><td>9 + 5</td><td>12 - 8</td></tr>
            <tr><td>4 + 6</td><td>13 - 7</td><td>3 + 8</td><td>14 - 9</td><td>8 + 3</td><td>15 - 5</td></tr>
            <tr><td>6 + 7</td><td>16 - 4</td><td>2 + 9</td><td>17 - 8</td><td>5 + 5</td><td>18 - 9</td></tr>
            <tr><td>7 + 1</td><td>19 - 6</td><td>6 + 6</td><td>20 - 7</td><td>4 + 9</td><td>21 - 9</td></tr>
          </tbody>
        </table>
        <div class="overlay">
          <div class="overlay-card">Preview Mode: this roll-table is locked and non-clickable.</div>
        </div>
      </div>
    </section>

    <section class="demo-card" aria-label="Playable counting demo">
      <h3>Playable Counting Demo (Try This One)</h3>
      <p class="demo-sub">Answer the counting prompt correctly to place your X or O.</p>
      <p class="score" id="scoreLine">X Wins: 0 | O Wins: 0 | Ties: 0</p>
      <p class="demo-status" id="demoStatus">Turn: X</p>
      <div class="demo-grid" id="demoGrid"></div>
      <div class="demo-actions">
        <button type="button" class="demo-btn" id="demoSameBoard">Play Again (Same Prompts)</button>
        <button type="button" class="demo-btn" id="demoNewBoard">New Counting Board</button>
      </div>
    </section>
  </main>

  <div class="dialog" id="answerDialog" aria-hidden="true">
    <div class="dialog-card" role="dialog" aria-modal="true" aria-labelledby="dialogTitle">
      <div class="dialog-title" id="dialogTitle">Enter Answer</div>
      <div class="dialog-problem" id="dialogProblem"></div>
      <input id="dialogInput" class="dialog-input" type="text" inputmode="numeric" autocomplete="off" />
      <div id="dialogMsg" class="dialog-msg"></div>
      <div class="dialog-actions">
        <button type="button" class="demo-btn" id="dialogCancel">Cancel</button>
        <button type="button" class="demo-btn" id="dialogSubmit">Check</button>
      </div>
    </div>
  </div>

  <script>
    const tabs = Array.from(document.querySelectorAll(".mode-tab"));
    const panels = Array.from(document.querySelectorAll(".panel"));

    function selectMode(mode) {
      tabs.forEach((tab) => tab.classList.toggle("active", tab.dataset.mode === mode));
      panels.forEach((panel) => panel.classList.toggle("active", panel.dataset.panel === mode));
    }

    tabs.forEach((tab) => {
      tab.addEventListener("click", () => selectMode(tab.dataset.mode));
    });

    const WIN_LINES = [
      [0, 1, 2],
      [3, 4, 5],
      [6, 7, 8],
      [0, 3, 6],
      [1, 4, 7],
      [2, 5, 8],
      [0, 4, 8],
      [2, 4, 6]
    ];

    const COUNTING_POOL = [
      { seq: "1, 2, 3, __", answer: 4 },
      { seq: "5, 6, 7, __", answer: 8 },
      { seq: "9, 8, 7, __", answer: 6 },
      { seq: "10, 11, 12, __", answer: 13 },
      { seq: "15, 14, 13, __", answer: 12 },
      { seq: "2, 4, 6, __", answer: 8 },
      { seq: "12, 10, 8, __", answer: 6 },
      { seq: "3, 6, 9, __", answer: 12 },
      { seq: "20, 19, 18, __", answer: 17 },
      { seq: "7, 9, 11, __", answer: 13 },
      { seq: "4, 5, 6, __", answer: 7 },
      { seq: "18, 16, 14, __", answer: 12 }
    ];

    const demoGrid = document.getElementById("demoGrid");
    const demoStatus = document.getElementById("demoStatus");
    const scoreLine = document.getElementById("scoreLine");

    const answerDialog = document.getElementById("answerDialog");
    const dialogProblem = document.getElementById("dialogProblem");
    const dialogInput = document.getElementById("dialogInput");
    const dialogMsg = document.getElementById("dialogMsg");
    const dialogSubmit = document.getElementById("dialogSubmit");
    const dialogCancel = document.getElementById("dialogCancel");

    const demo = {
      prompts: [],
      marks: Array(9).fill(""),
      turn: "X",
      over: false,
      score: { X: 0, O: 0, T: 0 },
      pendingIndex: -1
    };

    function shuffle(list) {
      const out = list.slice();
      for (let i = out.length - 1; i > 0; i -= 1) {
        const j = Math.floor(Math.random() * (i + 1));
        const t = out[i];
        out[i] = out[j];
        out[j] = t;
      }
      return out;
    }

    function newPromptSet() {
      return shuffle(COUNTING_POOL).slice(0, 9);
    }

    function winningLine() {
      return WIN_LINES.find(([a, b, c]) => {
        return demo.marks[a] && demo.marks[a] === demo.marks[b] && demo.marks[b] === demo.marks[c];
      }) || null;
    }

    function updateScoreLine() {
      scoreLine.textContent = `X Wins: ${demo.score.X} | O Wins: ${demo.score.O} | Ties: ${demo.score.T}`;
    }

    function updateStatus(text, kind) {
      demoStatus.textContent = text;
      demoStatus.className = "demo-status" + (kind === "good" ? " good" : kind === "bad" ? " bad" : "");
    }

    function renderDemoBoard() {
      demoGrid.innerHTML = "";
      demo.prompts.forEach((prompt, index) => {
        const mark = demo.marks[index];
        const locked = Boolean(mark) || demo.over;
        const cell = document.createElement("button");
        cell.type = "button";
        cell.className = "demo-cell" + (locked ? " locked" : "");
        cell.dataset.index = String(index);
        cell.innerHTML = `<div class=\"demo-prompt\">${prompt.seq}</div><div class=\"demo-mark ${mark === "X" ? "x" : mark === "O" ? "o" : ""}\">${mark}</div>`;
        if (locked) cell.disabled = true;
        demoGrid.appendChild(cell);
      });
    }

    function resetBoardOnly() {
      demo.marks = Array(9).fill("");
      demo.turn = "X";
      demo.over = false;
      demo.pendingIndex = -1;
      renderDemoBoard();
      updateStatus("Turn: X");
    }

    function newBoard() {
      demo.prompts = newPromptSet();
      resetBoardOnly();
    }

    function openDialog(index) {
      demo.pendingIndex = index;
      dialogProblem.textContent = demo.prompts[index].seq;
      dialogInput.value = "";
      dialogMsg.textContent = "";
      answerDialog.classList.add("open");
      answerDialog.setAttribute("aria-hidden", "false");
      setTimeout(() => dialogInput.focus(), 10);
    }

    function closeDialog() {
      answerDialog.classList.remove("open");
      answerDialog.setAttribute("aria-hidden", "true");
      dialogMsg.textContent = "";
      demo.pendingIndex = -1;
    }

    function commitMark(index) {
      demo.marks[index] = demo.turn;
      const line = winningLine();
      if (line) {
        demo.over = true;
        demo.score[demo.turn] += 1;
        updateScoreLine();
        updateStatus(`${demo.turn} wins this counting round.`, "good");
      } else if (demo.marks.every(Boolean)) {
        demo.over = true;
        demo.score.T += 1;
        updateScoreLine();
        updateStatus("Tie game on this counting round.", "good");
      } else {
        demo.turn = demo.turn === "X" ? "O" : "X";
        updateStatus(`Turn: ${demo.turn}`);
      }
      renderDemoBoard();
    }

    function checkDialogAnswer() {
      const idx = demo.pendingIndex;
      if (idx < 0 || idx > 8) {
        closeDialog();
        return;
      }
      const raw = dialogInput.value.trim();
      const value = Number(raw);
      if (!raw || !Number.isFinite(value)) {
        dialogMsg.textContent = "Enter a number.";
        return;
      }

      const needed = demo.prompts[idx].answer;
      if (value === needed) {
        closeDialog();
        commitMark(idx);
      } else {
        dialogMsg.textContent = "Not correct yet. Try again.";
      }
    }

    demoGrid.addEventListener("click", (event) => {
      const cell = event.target.closest(".demo-cell");
      if (!cell || demo.over) return;
      const index = Number(cell.dataset.index);
      if (!Number.isFinite(index) || demo.marks[index]) return;
      openDialog(index);
    });

    dialogSubmit.addEventListener("click", checkDialogAnswer);
    dialogCancel.addEventListener("click", closeDialog);
    answerDialog.addEventListener("click", (event) => {
      if (event.target === answerDialog) closeDialog();
    });

    dialogInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        checkDialogAnswer();
      }
      if (event.key === "Escape") {
        event.preventDefault();
        closeDialog();
      }
    });

    document.getElementById("demoSameBoard").addEventListener("click", resetBoardOnly);
    document.getElementById("demoNewBoard").addEventListener("click", newBoard);

    window.addEventListener("keydown", (event) => {
      const blocked = (event.ctrlKey || event.metaKey) && ["s", "p", "u"].includes(event.key.toLowerCase());
      if (blocked) event.preventDefault();
    });

    updateScoreLine();
    newBoard();
  </script>
</body>
</html>
