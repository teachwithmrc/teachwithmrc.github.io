<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Phonics Board Game Generator</title>
  <script src="fluencyDataFull_v3.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 20px;
      text-align: center;
    }

    h1 {
      font-size: 26px;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 16px;
      margin-bottom: 20px;
    }

    .skill-button-grid {
      display: flex;
      flex-direction: column;
      gap: 8px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .skill-button-grid .row {
      display: flex;
      justify-content: center;
      gap: 8px;
    }

    .skill-button {
      border: 2px solid #000;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }

    .skill-button.selected {
      background-color: #007bff;
      color: white;
    }

    table.board {
      border-collapse: collapse;
      margin: 0 auto;
    }

    td {
      width: 75px;
      height: 75px;
      text-align: center;
      vertical-align: middle;
    }

    .board-cell {
      border-radius: 50%;
      border: 2px solid black;
      font-size: 18px;
      font-weight: bold;
      color: black;
      background-color: lightblue;
      word-wrap: break-word;
      padding: 4px;
    }

    .empty-cell {
      border: none;
      background: none;
    }

    @media print {
      @page { size: landscape; }
      body * { visibility: hidden; }
      #printableSection, #printableSection * { visibility: visible; }
      #printableSection {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Phonics Board Game Generator</h1>
  <div class="subtitle">Select your skill(s) and generate a random path board.</div>

  <div class="skill-button-grid">
    <div class="row">
      <div class="skill-button" data-skill="0.1">Short A</div>
      <div class="skill-button" data-skill="0.2">Short O</div>
      <div class="skill-button" data-skill="0.3">Short I</div>
      <div class="skill-button" data-skill="0.4">Short U</div>
      <div class="skill-button" data-skill="0.5">Short E</div>
    </div>
    <div class="row">
      <div class="skill-button" data-skill="0.6">FLSZ</div>
      <div class="skill-button" data-skill="0.7">CVC & FLSZ</div>
      <div class="skill-button" data-skill="mixed">Mixed CVC</div>
    </div>
  </div>

  <div style="margin-bottom: 20px;">
    <label>Path Style:
      <select id="pathStyle">
        <option value="box">Box Loop</option>
        <option value="s">S-Shape</option>
        <option value="spiral">Spiral</option>
        <option value="zigzag">Zig-Zag</option>
      </select>
    </label>

    <label style="margin-left: 20px;">Colors:
      <select id="colorMode">
        <option value="color">Color</option>
        <option value="bw">Black & White</option>
      </select>
    </label>
  </div>

  <button onclick="generateBoard()" style="font-size: 18px; padding: 10px 24px;">Generate Board</button>
  <button onclick="window.print()" style="font-size: 18px; padding: 10px 24px;">Print</button>

  <div id="printableSection" style="margin-top: 20px;"></div>

<script>
  const selectedSkills = new Set();
  const colors = ['#FF9999','#FFCC99','#FFFF99','#CCFF99','#99FFCC','#99CCFF','#CC99FF','#FF99CC'];

  const skillLabelMap = {
    "0.1": "Short A",
    "0.2": "Short O",
    "0.3": "Short I",
    "0.4": "Short U",
    "0.5": "Short E",
    "0.6": "FLSZ",
    "0.7": "FLSZ and CVC",
    "mixed": "Mixed CVC"
  };

  document.querySelectorAll('.skill-button').forEach(button => {
    button.addEventListener('click', () => {
      const skill = button.dataset.skill;
      if (selectedSkills.has(skill)) {
        selectedSkills.delete(skill);
        button.classList.remove('selected');
      } else {
        selectedSkills.add(skill);
        button.classList.add('selected');
      }
    });
  });

  // Path definitions
  const paths = {
    box: [
      [0,0],[0,1],[0,2],[0,3],[0,4],[0,5],
      [1,5],[2,5],[3,5],[4,5],[5,5],
      [5,4],[5,3],[5,2],[5,1],[5,0],
      [4,0],[3,0],[2,0],[1,0]
    ],
    s: [
      [0,0],[0,1],[0,2],[0,3],[0,4],[0,5],
      [1,5],[2,5],[2,4],[2,3],[2,2],[2,1],[2,0],
      [3,0],[4,0],[4,1],[4,2],[4,3],[4,4],[4,5]
    ],
    spiral: [
      [0,0],[0,1],[0,2],[0,3],[0,4],
      [1,4],[2,4],[3,4],[3,3],[3,2],[3,1],
      [2,1],[1,1],[1,2],[1,3],[2,3],[2,2]
    ],
    zigzag: [
      [0,0],[0,1],[0,2],[0,3],[0,4],[0,5],
      [1,5],[1,4],[1,3],[1,2],[1,1],[1,0],
      [2,0],[2,1],[2,2],[2,3],[2,4],[2,5]
    ]
  };

  function generateBoard() {
    const skills = Array.from(selectedSkills);
    if (skills.length === 0) {
      alert("Please select at least one skill.");
      return;
    }

    const pathKey = document.getElementById('pathStyle').value;
    const pathCoords = paths[pathKey];
    const colorMode = document.getElementById('colorMode').value;

    // Get words from fluencyData
    const allWords = [];
    for (const skill of skills) {
      let key;
      if (skill === "mixed") key = "Mixed CVC"; 
      else if (skill === "0.6" || skill === "0.7") key = `${skill} - ${skillLabelMap[skill]}`;
      else key = `${skill} - ${skillLabelMap[skill]} Words`;

      if (window.fluencyData.words[key]) allWords.push(...window.fluencyData.words[key]);
    }

    if (allWords.length === 0) {
      alert("No words found for the selected skill(s).");
      return;
    }

    const shuffled = allWords.sort(() => 0.5 - Math.random());
    const wordsForPath = shuffled.slice(0, pathCoords.length - 2); // leave 1 for START and 1 for FINISH

    // Create 6x6 board for visual spacing
    const table = document.createElement('table');
    table.className = 'board';
    for (let r = 0; r < 6; r++) {
      const row = table.insertRow();
      for (let c = 0; c < 6; c++) {
        const cell = row.insertCell();
        cell.className = 'empty-cell';
      }
    }

    // Fill path
    pathCoords.forEach((coord, i) => {
      const [r, c] = coord;
      const cell = table.rows[r].cells[c];
      cell.className = 'board-cell';
      if (colorMode === 'color') {
        cell.style.backgroundColor = colors[i % colors.length];
      } else {
        cell.style.backgroundColor = 'white';
      }
      if (i === 0) {
        cell.textContent = 'START';
      } else if (i === pathCoords.length - 1) {
        cell.textContent = 'FINISH!';
      } else {
        cell.textContent = wordsForPath[i-1] || "";
      }
    });

    const printableSection = document.getElementById('printableSection');
    printableSection.innerHTML = '';
    printableSection.appendChild(table);
  }
</script>
</body>
</html>
