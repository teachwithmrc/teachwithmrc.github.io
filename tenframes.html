<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ten Frame Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  *{ box-sizing:border-box; }
  html, body{
    margin:0; padding:0;
    font-family:Poppins, Arial, sans-serif;
    background:#fff; color:#111;
    overflow-x:hidden;
  }

  .wrap{ max-width:900px; margin:0 auto; padding:12px; }

  /* CONTROLS */
  .controls{
    border:2px solid #111; border-radius:12px;
    padding:10px; margin-bottom:12px;
  }
  .controls-row{
    display:flex; flex-wrap:wrap;
    gap:10px 12px; align-items:flex-end;
  }
  .field{ display:flex; flex-direction:column; gap:4px; }
  label{ font-size:12px; font-weight:800; }
  select,input{
    height:36px; min-width:170px;
    border:2px solid #111; border-radius:10px;
    padding:6px 10px; font-family:Poppins;
    background:#fff; font-size:14px;
  }
  .check{
    display:flex; align-items:center; gap:8px;
    font-size:13px; font-weight:700; user-select:none;
    padding:6px 0 0;
  }
  .check input{ width:18px; height:18px; }

  button{
    height:38px; padding:0 16px;
    border:2px solid #111; border-radius:10px;
    font-weight:900; background:#111; color:#fff;
    cursor:pointer;
  }
  button.secondary{ background:#fff; color:#111; }

  /* SHEET */
  .title{
    text-align:center;
    font-size:28px;            /* slightly smaller for print */
    font-weight:900;
    margin:6px 0 10px;
  }

  /* BLACK OUTLINES (no gray) */
  .table{ border:2px solid #111; }
  .row{ display:grid; grid-template-columns:1fr 1fr; }

  .cell{
    border-right:2px solid #111;
    border-bottom:2px solid #111;
    min-height:190px;          /* slightly smaller */
    padding:10px;
    display:flex; flex-direction:column;
    align-items:center; gap:10px;
  }
  .row .cell:last-child{ border-right:none; }
  .table .row:last-child .cell{ border-bottom:none; }

  .expr{
    font-size:22px;            /* slightly smaller */
    font-weight:900;
    text-align:center;
    line-height:1.1;
  }
  .blank{
    display:inline-block;
    width:95px;
    border-bottom:3px solid #111;
    transform: translateY(-3px);
  }

  /* TEN FRAMES */
  .frames{
    display:grid;
    gap:10px;
    width:235px;               /* smaller = prints safer */
  }
  .tenframe{ border:2px solid #111; }
  .tfgrid{
    display:grid;
    grid-template-columns:repeat(5,1fr);
  }
  .tfcell{
    border:2px solid #111;
    height:34px;               /* smaller for print, not tiny */
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
  }

  .footer{
    text-align:center;
    font-size:12px;
    font-weight:800;
    margin-top:10px;
  }

  @media print{
    .controls{ display:none; }
    .wrap{ padding:0; }
  }
</style>
</head>

<body>
<div class="wrap">

  <div class="controls">
    <div class="controls-row">
      <div class="field">
        <label>Operation</label>
        <select id="mode">
          <option value="add">Addition</option>
          <option value="sub">Subtraction</option>
        </select>
      </div>

      <div class="field">
        <label>Lowest # (first number)</label>
        <input id="min" type="number" value="0" min="0" max="20">
      </div>

      <div class="field">
        <label>Highest # (first number)</label>
        <input id="max" type="number" value="20" min="1" max="20">
      </div>

      <div class="check">
        <input id="prefill" type="checkbox" checked>
        <label for="prefill">Prefill first number</label>
      </div>

      <div class="check" id="allowTwoDigitWrap">
        <input id="allowTwoDigit" type="checkbox">
        <label for="allowTwoDigit">Allow 2-digit first number (default OFF)</label>
      </div>

      <div class="check" id="biggerFirstWrap">
        <input id="biggerFirst" type="checkbox" checked>
        <label for="biggerFirst">Bigger number first (addition)</label>
      </div>

      <button type="button" onclick="build()">Generate</button>
      <button type="button" class="secondary" onclick="window.print()">Print</button>
    </div>
  </div>

  <div class="title">Add and Subtract Using Ten Frames</div>
  <div class="table" id="table"></div>
  <div class="footer">Copyright - Generated from InterventionStation.com - @TeachWithMrC</div>

</div>

<script>
  const $ = (id) => document.getElementById(id);

  function clamp(n,a,b){ return Math.max(a, Math.min(b,n)); }
  function r(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

  function normalizeBounds(){
    let lo = clamp(parseInt($("min").value || "0",10), 0, 20);
    let hi = clamp(parseInt($("max").value || "20",10), 1, 20);
    if (hi < lo) [lo,hi] = [hi,lo];
    $("min").value = lo;
    $("max").value = hi;
    return { lo, hi };
  }

  // Ten-frame fill (0..20) across two frames
  function dots(n){
    n = clamp(n,0,20);
    const f1 = Array(10).fill(false);
    const f2 = Array(10).fill(false);
    for(let i=0;i<Math.min(10,n);i++) f1[i] = true;
    for(let i=0;i<Math.max(0,n-10);i++) f2[i] = true;
    return [f1,f2];
  }

  // SVG circle dot (prints reliably)
  function dotSVG(){
    const ns="http://www.w3.org/2000/svg";
    const svg=document.createElementNS(ns,"svg");
    svg.setAttribute("viewBox","0 0 100 100");
    svg.style.width="84%";
    svg.style.height="84%";
    const c=document.createElementNS(ns,"circle");
    c.setAttribute("cx","50");
    c.setAttribute("cy","50");
    c.setAttribute("r","43");
    c.setAttribute("fill","#111");
    svg.appendChild(c);
    return svg;
  }

  function frame(arr){
    const ten=document.createElement("div");
    ten.className="tenframe";
    const g=document.createElement("div");
    g.className="tfgrid";
    arr.forEach((on)=>{
      const cell=document.createElement("div");
      cell.className="tfcell";
      if(on) cell.appendChild(dotSVG());
      g.appendChild(cell);
    });
    ten.appendChild(g);
    return ten;
  }

  // uniqueness keys
  function keyFor(mode, a, b){
    if(mode === "add"){
      const x = Math.min(a,b);
      const y = Math.max(a,b);
      return `A:${x}+${y}`; // no commutative duplicates
    }
    return `S:${a}-${b}`;   // no exact duplicates
  }

  function buildProblemCell(mode, a, b, prefill){
    const cell = document.createElement("div");
    cell.className = "cell";

    const op = (mode === "add") ? "+" : "−";
    cell.innerHTML = `<div class="expr">${a} ${op} ${b} = <span class="blank"></span></div>`;

    const fs = document.createElement("div");
    fs.className = "frames";

    if(prefill){
      const [a1,a2] = dots(a);
      fs.appendChild(frame(a1));
      fs.appendChild(frame(a2));
    } else {
      fs.appendChild(frame(Array(10).fill(false)));
      fs.appendChild(frame(Array(10).fill(false)));
    }

    cell.appendChild(fs);
    return cell;
  }

  // ===== NEW DEFAULT RULES =====
  // ADDITION DEFAULT:
  // - two single-digit numbers (1..9) ONLY (prevents 18+2)
  // - sum MUST be > 10 (always)
  // - still "make-a-ten-ish": a is biased to 6..9
  // OPTIONAL:
  // - if Allow 2-digit first number is ON, a can be 0..20 within bounds
  function makeAddition(lo, hi, allowTwoDigit){
    for(let t=0; t<4000; t++){
      let a, b;

      if(!allowTwoDigit){
        a = r(6,9);       // bias toward make-a-ten
        b = r(1,9);
      } else {
        a = r(lo, hi);    // teacher explicitly allows it
        b = r(1,9);
      }

      const sum = a + b;

      // must be > 10 always
      if(sum <= 10) continue;

      // keep within 20 for ten-frame logic
      if(sum > 20) continue;

      // apply bounds to FIRST number only
      if(a < lo || a > hi) continue;

      // if allowTwoDigit is OFF, force a to be single-digit too
      if(!allowTwoDigit && a > 9) continue;

      return { a, b, ans: sum };
    }

    // fallback
    return { a:9, b:4, ans:13 };
  }

  // SUBTRACTION DEFAULT (kept teacher-friendly):
  // - first number respects bounds
  // - bias toward crossing 10 when possible
  function makeSubtraction(lo, hi, allowTwoDigit){
    for(let t=0; t<5000; t++){
      let a, b;

      // If allowTwoDigit is OFF, still allow 11..18 for subtraction? (it’s subtraction over 10 skill)
      // But user’s current request is mostly addition rules; we keep subtraction reasonable.
      a = r(Math.max(lo, 11), hi);  // keep it over 10 to match the skill
      if(!allowTwoDigit && a > 18) continue; // keep it in the common "teen" zone unless enabled

      // pick b to (usually) cross 10: b > (a-10)
      const bMin = Math.max(1, (a - 10) + 1);
      const bMax = Math.min(9, a - 1);
      if(bMin > bMax) continue;

      b = r(bMin, bMax);
      const ans = a - b;

      if(ans < 0) continue;

      return { a, b, ans };
    }

    return { a:15, b:7, ans:8 };
  }

  function build(){
    const { lo, hi } = normalizeBounds();
    const mode = $("mode").value;
    const prefill = $("prefill").checked;
    const allowTwoDigit = $("allowTwoDigit").checked;
    const biggerFirst = $("biggerFirst").checked;

    // Only show biggerFirst for addition; two-digit option helpful for both
    $("biggerFirstWrap").style.display = (mode === "add") ? "flex" : "none";

    const qs = [];
    const seen = new Set();
    let guard = 0;

    while(qs.length < 8 && guard < 12000){
      guard++;

      let q = (mode === "add")
        ? makeAddition(lo, hi, allowTwoDigit)
        : makeSubtraction(lo, hi, allowTwoDigit);

      let a = q.a, b = q.b;

      // Bigger number first (addition)
      if(mode === "add" && biggerFirst && b > a){
        [a,b] = [b,a];
      }

      const k = keyFor(mode, a, b);
      if(seen.has(k)) continue;
      seen.add(k);

      qs.push({ a, b });
    }

    const table = $("table");
    table.innerHTML = "";

    for(let row=0; row<4; row++){
      const rowEl = document.createElement("div");
      rowEl.className = "row";

      const left = qs[row*2];
      const right = qs[row*2 + 1];

      rowEl.appendChild(buildProblemCell(mode, left.a, left.b, prefill));
      rowEl.appendChild(buildProblemCell(mode, right.a, right.b, prefill));

      table.appendChild(rowEl);
    }
  }

  ["mode","min","max","prefill","allowTwoDigit","biggerFirst"].forEach(id=>{
    $(id).addEventListener("change", build);
  });

  build();
</script>
</body>
</html>
