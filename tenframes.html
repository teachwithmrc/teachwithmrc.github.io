<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ten Frame Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  *{ box-sizing:border-box; }
  html, body{
    margin:0; padding:0;
    font-family:"Poppins", Arial, sans-serif;
    background:#fff; color:#111;
    overflow-x:hidden;
  }
  .wrap{ max-width:980px; margin:0 auto; padding:12px; }

  /* ========= TOP MENU (TABS) ========= */
  .menu{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
    margin-bottom:12px;
  }
  .tab{
    border:2px solid #111;
    border-radius:14px;
    padding:10px 14px;
    font-weight:900;
    font-size:15px;
    cursor:pointer;
    background:#fff;
    color:#111;
    user-select:none;
  }
  .tab.active{
    background:#111;
    color:#fff;
  }

  /* ========= CONTROLS ========= */
  .controls{
    border:2px solid #111;
    border-radius:12px;
    padding:12px;
    margin-bottom:12px;
  }

  /* Line 1 */
  .controls-top{
    display:flex;
    flex-wrap:wrap;
    gap:12px;
    align-items:flex-end;
    justify-content:flex-start;
  }
  .field{
    display:flex;
    flex-direction:column;
    gap:6px;
    min-width:190px;
  }
  .field label{
    font-size:12px;
    font-weight:800;
  }
  select, input{
    height:40px;
    min-width:190px;
    border:2px solid #111;
    border-radius:10px;
    padding:8px 12px;
    font-family:"Poppins", Arial, sans-serif;
    font-size:14px;
    background:#fff;
  }

  /* Line 2 */
  .controls-checks{
    margin-top:10px;
    display:flex;
    flex-wrap:wrap;
    gap:18px;
    align-items:center;
  }
  .check{
    display:flex;
    align-items:center;
    gap:10px;
    font-size:16px;
    font-weight:800;
    user-select:none;
    margin:0;
    padding:0;
    line-height:1;
  }
  .check input{
    width:22px;
    height:22px;
    margin:0;
    padding:0;
    accent-color:#111;
  }

  /* Big centered buttons */
  .controls-actions{
    margin-top:12px;
    display:flex;
    justify-content:center;
    gap:14px;
    flex-wrap:wrap;
  }
  button{
    height:52px;
    padding:0 26px;
    border:2px solid #111;
    border-radius:14px;
    font-weight:900;
    font-size:17px;
    font-family:"Poppins", Arial, sans-serif;
    background:#111;
    color:#fff;
    cursor:pointer;
  }
  button.secondary{
    background:#fff;
    color:#111;
  }

  /* ========= SHEET ========= */
  .title{
    text-align:center;
    font-size:28px;
    font-weight:900;
    margin:6px 0 10px;
  }

  /* Black outlines everywhere */
  .table{ border:2px solid #111; }
  .row{ display:grid; grid-template-columns:1fr 1fr; }

  .cell{
    border-right:2px solid #111;
    border-bottom:2px solid #111;
    min-height:190px;
    padding:10px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
  }
  .row .cell:last-child{ border-right:none; }
  .table .row:last-child .cell{ border-bottom:none; }

  .expr{
    font-size:22px;
    font-weight:900;
    text-align:center;
    line-height:1.1;
  }
  .blank{
    display:inline-block;
    width:95px;
    border-bottom:3px solid #111;
    transform: translateY(-3px);
  }

  /* Frames */
  .frames{
    display:grid;
    gap:10px;
    width:235px;
  }
  .frames.one{ width:235px; }
  .frames.two{ width:235px; } /* same width; 2 frames stacked */
  .tenframe{ border:2px solid #111; }
  .tfgrid{
    display:grid;
    grid-template-columns:repeat(5,1fr);
  }
  .tfcell{
    border:2px solid #111;
    height:34px;
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
  }

  /* Optional cross-out overlay (sub within 10) */
  .cross::before, .cross::after{
    content:"";
    position:absolute;
    width:86%;
    height:3px;
    background:#111;
    top:50%;
    left:7%;
    transform-origin:center;
  }
  .cross::before{ transform:translateY(-50%) rotate(45deg); }
  .cross::after{  transform:translateY(-50%) rotate(-45deg); }

  .footer{
    text-align:center;
    font-size:12px;
    font-weight:800;
    margin-top:10px;
  }

  @media print{
    .menu, .controls{ display:none; }
    .wrap{ padding:0; }
  }
</style>
</head>

<body>
<div class="wrap">

  <!-- TOP MENU -->
  <div class="menu" id="menu">
    <div class="tab active" data-skill="over10_add">Add: Over 10 (to 20)</div>
    <div class="tab" data-skill="within10_add">Add: Within 10</div>
    <div class="tab" data-skill="within10_sub">Subtract: Within 10</div>
  </div>

  <!-- CONTROLS -->
  <div class="controls">
    <!-- LINE 1 -->
    <div class="controls-top">
      <div class="field">
        <label for="op">Operation</label>
        <select id="op">
          <option value="add">Addition</option>
          <option value="sub">Subtraction</option>
        </select>
      </div>

      <div class="field">
        <label for="min">Lowest # (first number)</label>
        <input id="min" type="number" value="0" min="0" max="20">
      </div>

      <div class="field">
        <label for="max">Highest # (first number)</label>
        <input id="max" type="number" value="20" min="1" max="20">
      </div>
    </div>

    <!-- LINE 2 -->
    <div class="controls-checks">
      <label class="check">
        <input id="prefill" type="checkbox" checked>
        Prefill
      </label>

      <label class="check" id="allowTwoDigitWrap">
        <input id="allowTwoDigit" type="checkbox">
        Allow 2-digit
      </label>

      <label class="check" id="biggerFirstWrap">
        <input id="biggerFirst" type="checkbox" checked>
        Bigger number first
      </label>

      <label class="check" id="crossOutWrap" style="display:none;">
        <input id="crossOut" type="checkbox" checked>
        Show cross-out
      </label>
    </div>

    <!-- BUTTONS -->
    <div class="controls-actions">
      <button type="button" id="btnGen">Generate</button>
      <button type="button" class="secondary" id="btnPrint">Print</button>
    </div>
  </div>

  <div class="title" id="sheetTitle">Add and Subtract Using Ten Frames</div>
  <div class="table" id="table"></div>
  <div class="footer">Copyright - Generated from InterventionStation.com - @TeachWithMrC</div>

</div>

<script>
  const $ = (id) => document.getElementById(id);

  // ====== State (selected tab) ======
  let SKILL = "over10_add";

  function clamp(n,a,b){ return Math.max(a, Math.min(b,n)); }
  function r(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

  function normalizeBounds(){
    let lo = clamp(parseInt($("min").value || "0",10), 0, 20);
    let hi = clamp(parseInt($("max").value || "20",10), 1, 20);
    if (hi < lo) [lo,hi] = [hi,lo];
    $("min").value = lo;
    $("max").value = hi;
    return { lo, hi };
  }

  // Convert number into two frames of 10 booleans (works for 0..20)
  function dots(n){
    n = clamp(n,0,20);
    const f1 = Array(10).fill(false);
    const f2 = Array(10).fill(false);
    for(let i=0;i<Math.min(10,n);i++) f1[i]=true;
    for(let i=0;i<Math.max(0,n-10);i++) f2[i]=true;
    return [f1,f2];
  }

  // One-frame booleans (0..10)
  function dots10(n){
    n = clamp(n,0,10);
    const f = Array(10).fill(false);
    for(let i=0;i<n;i++) f[i]=true;
    return f;
  }

  // SVG dot (print-safe)
  function dotSVG(){
    const ns="http://www.w3.org/2000/svg";
    const svg=document.createElementNS(ns,"svg");
    svg.setAttribute("viewBox","0 0 100 100");
    svg.style.width="84%";
    svg.style.height="84%";
    const c=document.createElementNS(ns,"circle");
    c.setAttribute("cx","50");
    c.setAttribute("cy","50");
    c.setAttribute("r","43");
    c.setAttribute("fill","#111");
    svg.appendChild(c);
    return svg;
  }

  function buildFrame(arrBool, crossSet){
    const ten = document.createElement("div");
    ten.className = "tenframe";
    const g = document.createElement("div");
    g.className = "tfgrid";

    for(let i=0;i<10;i++){
      const cell = document.createElement("div");
      cell.className = "tfcell";
      if(arrBool[i]){
        cell.appendChild(dotSVG());
        if(crossSet && crossSet.has(i)) cell.classList.add("cross");
      }
      g.appendChild(cell);
    }
    ten.appendChild(g);
    return ten;
  }

  // ====== Uniqueness Keys ======
  function keyFor(mode, a, b){
    if(mode === "add"){
      const x = Math.min(a,b);
      const y = Math.max(a,b);
      return `A:${x}+${y}`; // no commutative duplicates
    }
    return `S:${a}-${b}`;
  }

  // ====== Problem generators ======

  // Add: Over 10 (to 20)
  // Defaults: single-digit addends (unless allowTwoDigit)
  // Always sum > 10, sum <= 20, avoid 20 + anything by default usage pattern.
  function gen_over10_add(lo, hi, allowTwoDigit){
    for(let t=0; t<8000; t++){
      let a,b;

      if(!allowTwoDigit){
        a = r(6,9);
        b = r(1,9);
        if(a < lo || a > hi) continue;
      } else {
        a = r(lo, hi);
        b = r(1,9);
      }

      const sum = a + b;
      if(sum <= 10) continue;
      if(sum > 20) continue;

      // guardrail: avoid "18+2" style by default (already prevented when !allowTwoDigit)
      if(!allowTwoDigit && (a > 9 || b > 9)) continue;

      return { a, b };
    }
    return { a:9, b:4 };
  }

  // Add: Within 10
  // One ten frame, two single-digit addends, sum <= 10
  function gen_within10_add(){
    for(let t=0; t<12000; t++){
      const a = r(0,9);
      const b = r(0,9);
      const sum = a + b;
      if(sum > 10) continue;
      // avoid too many "0 + 0"
      if(a === 0 && b === 0) continue;
      return { a, b };
    }
    return { a:5, b:3 };
  }

  // Subtract: Within 10
  // One ten frame showing the first number (a), subtract b (<=a), result >=0
  function gen_within10_sub(){
    for(let t=0; t<12000; t++){
      const a = r(1,10);
      const b = r(0, a);
      if(a === 0) continue;
      if(a === b) continue; // avoid all-crossed / zero too often
      return { a, b };
    }
    return { a:9, b:4 };
  }

  // ====== Build the worksheet ======
  function build(){
    const { lo, hi } = normalizeBounds();

    // Determine mode + rows + frames based on tab
    let mode = "add";
    let rows = 4;              // default: 8 problems
    let framesCount = 2;       // default: two frames
    let title = "Add and Subtract Using Ten Frames";

    if(SKILL === "over10_add"){
      mode = "add";
      rows = 4;          // 8 problems
      framesCount = 2;
      title = "Add Over 10 (to 20) Using Ten Frames";
    }
    if(SKILL === "within10_add"){
      mode = "add";
      rows = 5;          // 10 problems
      framesCount = 1;
      title = "Add Within 10 Using Ten Frames";
    }
    if(SKILL === "within10_sub"){
      mode = "sub";
      rows = 5;          // 10 problems
      framesCount = 1;
      title = "Subtract Within 10 Using Ten Frames";
    }

    $("sheetTitle").textContent = title;

    // Sync operation dropdown to match tab (so it’s obvious)
    $("op").value = mode;

    // Show/hide controls per skill
    const isAdd = (mode === "add");
    $("biggerFirstWrap").style.display = (isAdd ? "flex" : "none");
    $("allowTwoDigitWrap").style.display = (SKILL === "over10_add" ? "flex" : "none");
    $("crossOutWrap").style.display = (SKILL === "within10_sub" ? "flex" : "none");

    const prefill = $("prefill").checked;
    const allowTwoDigit = $("allowTwoDigit").checked;
    const biggerFirst = $("biggerFirst").checked;
    const showCross = $("crossOut").checked;

    // For within-10 pages, min/max aren’t needed — but we’ll keep them harmless.
    // For over-10 page, min/max apply to FIRST number only (as we set up earlier).
    if(SKILL !== "over10_add"){
      // keep bounds safe but not restrictive
      $("min").value = 0;
      $("max").value = 20;
    }

    const totalProblems = rows * 2;

    // Generate with uniqueness
    const qs = [];
    const seen = new Set();
    let guard = 0;

    while(qs.length < totalProblems && guard < 40000){
      guard++;

      let q;
      if(SKILL === "over10_add") q = gen_over10_add(lo, hi, allowTwoDigit);
      if(SKILL === "within10_add") q = gen_within10_add();
      if(SKILL === "within10_sub") q = gen_within10_sub();

      let a = q.a, b = q.b;

      // Bigger number first affects ADDITION display (and therefore what gets prefilled)
      if(isAdd && biggerFirst && b > a){
        [a,b] = [b,a];
      }

      const k = keyFor(mode, a, b);
      if(seen.has(k)) continue;
      seen.add(k);

      qs.push({ a, b });
    }

    // Render table
    const table = $("table");
    table.innerHTML = "";

    for(let row=0; row<rows; row++){
      const rowEl = document.createElement("div");
      rowEl.className = "row";

      const left = qs[row*2];
      const right = qs[row*2+1];

      rowEl.appendChild(buildCell(mode, left.a, left.b, prefill, framesCount, showCross));
      rowEl.appendChild(buildCell(mode, right.a, right.b, prefill, framesCount, showCross));

      table.appendChild(rowEl);
    }
  }

  function buildCell(mode, a, b, prefill, framesCount, showCross){
    const cell = document.createElement("div");
    cell.className = "cell";

    const op = (mode === "add") ? "+" : "−";
    cell.innerHTML = `<div class="expr">${a} ${op} ${b} = <span class="blank"></span></div>`;

    const fs = document.createElement("div");
    fs.className = "frames " + (framesCount === 1 ? "one" : "two");

    if(framesCount === 2){
      // Over 10 page: show two frames representing FIRST number (a) if prefill
      if(prefill){
        const [a1,a2] = dots(a);
        fs.appendChild(buildFrame(a1));
        fs.appendChild(buildFrame(a2));
      } else {
        fs.appendChild(buildFrame(Array(10).fill(false)));
        fs.appendChild(buildFrame(Array(10).fill(false)));
      }
    } else {
      // Within 10 pages: one frame
      if(prefill){
        const frameBool = dots10(a);
        if(mode === "sub" && showCross){
          // cross out the last b dots (from the end of the filled set)
          const cross = new Set();
          for(let i=a-b; i<a; i++){
            if(i >= 0 && i < 10) cross.add(i);
          }
          fs.appendChild(buildFrame(frameBool, cross));
        } else {
          fs.appendChild(buildFrame(frameBool));
        }
      } else {
        fs.appendChild(buildFrame(Array(10).fill(false)));
      }
    }

    cell.appendChild(fs);
    return cell;
  }

  // ====== Menu handling ======
  function setSkill(skill){
    SKILL = skill;
    document.querySelectorAll(".tab").forEach(t=>{
      t.classList.toggle("active", t.dataset.skill === skill);
    });
    build();
  }

  $("menu").addEventListener("click", (e)=>{
    const tab = e.target.closest(".tab");
    if(!tab) return;
    setSkill(tab.dataset.skill);
  });

  // Buttons
  $("btnGen")?.addEventListener("click", build);
  $("btnPrint")?.addEventListener("click", () => window.print());

  // Controls trigger rebuild
  ["prefill","allowTwoDigit","biggerFirst","crossOut","min","max"].forEach(id=>{
    const el = $(id);
    if(el) el.addEventListener("change", build);
  });

  // Make sure top action buttons exist
  $("btnGen").addEventListener("click", build);
  $("btnPrint").addEventListener("click", () => window.print());

  // Initial build
  build();
</script>
</body>
</html>
