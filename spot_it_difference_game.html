<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spot It Two-Card Match</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --ink: #172230;
      --paper: #fffefa;
      --line: #bfd6ea;
      --accent: #0e6ea8;
      --bad: #ba2c2c;
      --good: #1a7a45;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Poppins", "Avenir Next", "Segoe UI", sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 8% 8%, #ffffff 0%, #ffffff 24%, #eff6ff 64%, #e8f2ff 100%);
      padding: 16px;
    }

    .app {
      max-width: 1120px;
      margin: 0 auto;
      display: grid;
      gap: 14px;
    }

    h1 {
      margin: 0;
      text-align: center;
      font-size: clamp(1.45rem, 3.4vw, 2.2rem);
      line-height: 1.15;
    }

    .subtitle {
      margin: 0;
      text-align: center;
      color: #325068;
      font-weight: 600;
      font-size: 0.96rem;
    }

    .panel {
      background: var(--paper);
      border: 2px solid var(--line);
      border-radius: 14px;
      padding: 12px;
    }

    .controls {
      display: grid;
      gap: 12px;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px 14px;
    }

    .field {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: 1px solid #c8daeb;
      border-radius: 999px;
      padding: 6px 11px;
      background: #fff;
      font-size: 0.95rem;
    }

    .stack {
      width: 100%;
      display: grid;
      gap: 6px;
    }

    label {
      font-weight: 600;
      color: #25435c;
      font-size: 0.93rem;
    }

    input[type="text"],
    input[type="number"],
    textarea,
    button {
      font: inherit;
    }

    input[type="text"],
    input[type="number"],
    textarea {
      border: 1px solid #b9cee2;
      border-radius: 10px;
      padding: 7px 9px;
      background: #fff;
      color: var(--ink);
    }

    input[type="number"] {
      width: 84px;
    }

    textarea {
      min-height: 72px;
      resize: vertical;
      width: min(100%, 640px);
    }

    .checkline {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 14px;
      align-items: center;
    }

    .checkline label {
      border: 1px solid #c8daeb;
      border-radius: 999px;
      padding: 6px 10px;
      background: #fff;
      display: inline-flex;
      align-items: center;
      gap: 7px;
      cursor: pointer;
    }

    button {
      border: 1px solid #12344d;
      border-radius: 10px;
      padding: 9px 12px;
      font-weight: 700;
      color: #fff;
      background: var(--accent);
      cursor: pointer;
    }

    button.secondary {
      background: #fff;
      color: #163954;
    }

    button:hover {
      filter: brightness(0.97);
    }

    .status {
      min-height: 1.35rem;
      font-weight: 700;
      color: #2e4d68;
    }

    .status.good { color: var(--good); }
    .status.bad { color: var(--bad); }

    .stats {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .pill {
      border: 1px solid #c1d5e7;
      border-radius: 999px;
      background: #fff;
      padding: 7px 11px;
      font-weight: 700;
      font-size: 0.92rem;
      color: #264760;
    }

    .game-grid {
      display: grid;
      gap: 14px;
    }

    .pair-wrap {
      border: 2px dashed #98bfd9;
      border-radius: 14px;
      padding: 10px;
      background: #f8fbff;
    }

    .pair-wrap h2 {
      margin: 0 0 10px;
      font-size: 1.1rem;
      color: #23445e;
      text-align: center;
    }

    .pair {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      align-items: stretch;
    }

    .card-shell {
      border: 2px solid #9bbfda;
      border-radius: 14px;
      background: #ffffff;
      padding: 8px;
      display: grid;
      justify-items: center;
      gap: 7px;
    }

    .card-shell.correct {
      border-color: #1f8a4f;
      background: #f0fbf4;
      box-shadow: 0 0 0 2px rgba(31, 138, 79, 0.15) inset;
    }

    .card-shell.missed {
      border-color: #d26f6f;
      background: #fff3f3;
      box-shadow: 0 0 0 2px rgba(210, 111, 111, 0.15) inset;
    }

    .card-label {
      font-weight: 700;
      color: #2d4d66;
      font-size: 0.9rem;
    }

    .card {
      width: min(100%, 230px);
      aspect-ratio: 1 / 1;
      border: 3px solid #245678;
      border-radius: 50%;
      position: relative;
      background:
        radial-gradient(circle at 25% 22%, #ffffff 0%, #ffffff 28%, #f4fbff 64%, #ecf7ff 100%);
      overflow: hidden;
    }

    .token-btn {
      position: absolute;
      left: 50%;
      top: 50%;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.92);
      border: 1px solid #d3e3f1;
      font-family: inherit;
      font-weight: 700;
      font-size: clamp(0.78rem, 1.95vw, 0.96rem);
      color: #1f3d54;
      white-space: nowrap;
      max-width: 98px;
      overflow: hidden;
      text-overflow: ellipsis;
      cursor: pointer;
      transition: transform 120ms ease, border-color 120ms ease, background-color 120ms ease;
    }

    .token-btn:hover {
      border-color: #6da3cb;
      transform: translate(-50%, -50%) scale(1.04) rotate(var(--rot, 0deg));
    }

    .token-btn.correct {
      border-color: #1f8a4f;
      background: #dff7e8;
    }

    .token-btn.missed {
      border-color: #c44d4d;
      background: #ffe7e7;
    }

    .token-btn:disabled {
      cursor: default;
    }

    .footer {
      text-align: center;
      font-size: 0.78rem;
      color: #5f768b;
      padding-bottom: 4px;
    }

    @media (max-width: 760px) {
      body { padding: 12px; }
      .pair { grid-template-columns: 1fr; }
      .card { width: min(100%, 210px); }
    }

    @media print {
      .controls, .status, .stats, .footer {
        display: none !important;
      }
      body {
        background: #fff;
        padding: 0;
      }
      .panel, .pair-wrap, .card-shell, .card {
        border-color: #000 !important;
        box-shadow: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>Spot It - Two Card Match</h1>
    <p class="subtitle">Deal two cards and click the one symbol that appears on both cards.</p>

    <section class="panel controls" aria-label="Teacher setup">
      <div class="checkline">
        <label><input id="useLetters" type="checkbox" checked /> Letters</label>
        <label><input id="useWords" type="checkbox" /> Words</label>
        <label><input id="useNumbers" type="checkbox" /> Numbers</label>
      </div>

      <div class="stack">
        <label for="lettersInput">Letters (comma or space separated)</label>
        <input id="lettersInput" type="text" value="A, B, C, D, E, F, G, H, I, J, K, L" />
      </div>

      <div class="stack">
        <label for="wordsInput">Words (comma or one per line)</label>
        <textarea id="wordsInput" placeholder="cat, dog, run, jump"></textarea>
      </div>

      <div class="row">
        <div class="field">
          <label for="numStart">Number range</label>
          <input id="numStart" type="number" value="1" />
          <span>to</span>
          <input id="numEnd" type="number" value="20" />
        </div>

        <div class="field">
          <label for="itemsPerCard">Items per card</label>
          <input id="itemsPerCard" type="number" value="6" min="3" max="8" />
        </div>
      </div>

      <div class="row">
        <button id="dealBtn" type="button">Deal Deck</button>
        <button id="newRoundBtn" class="secondary" type="button">New Round</button>
        <button id="printBtn" class="secondary" type="button">Print</button>
      </div>
    </section>

    <div id="status" class="status" aria-live="polite"></div>

    <div class="stats" aria-label="Game score">
      <span class="pill">Rounds: <strong id="roundsValue">0</strong></span>
      <span class="pill">Correct: <strong id="correctValue">0</strong></span>
      <span class="pill">Accuracy: <strong id="accuracyValue">0%</strong></span>
    </div>

    <section class="panel game-grid">
      <div class="pair-wrap">
        <h2>Find The Match</h2>
        <div id="pairMount" class="pair"></div>
      </div>
    </section>

    <div class="footer">Copyright - InterventionStation.com - @TeachwithMrC</div>
  </div>

  <script>
    const els = {
      useLetters: document.getElementById("useLetters"),
      useWords: document.getElementById("useWords"),
      useNumbers: document.getElementById("useNumbers"),
      lettersInput: document.getElementById("lettersInput"),
      wordsInput: document.getElementById("wordsInput"),
      numStart: document.getElementById("numStart"),
      numEnd: document.getElementById("numEnd"),
      itemsPerCard: document.getElementById("itemsPerCard"),
      dealBtn: document.getElementById("dealBtn"),
      newRoundBtn: document.getElementById("newRoundBtn"),
      printBtn: document.getElementById("printBtn"),
      status: document.getElementById("status"),
      roundsValue: document.getElementById("roundsValue"),
      correctValue: document.getElementById("correctValue"),
      accuracyValue: document.getElementById("accuracyValue"),
      pairMount: document.getElementById("pairMount")
    };

    const state = {
      cardA: [],
      cardB: [],
      matchTokenKey: "",
      answered: false,
      rounds: 0,
      correct: 0
    };

    function setStatus(message, tone) {
      els.status.textContent = message || "";
      els.status.classList.remove("good", "bad");
      if (tone === "good") els.status.classList.add("good");
      if (tone === "bad") els.status.classList.add("bad");
    }

    function unique(items) {
      return [...new Set(items)];
    }

    function parseList(value) {
      return value
        .split(/[\n,;]+/)
        .map(token => token.trim())
        .filter(Boolean);
    }

    function parseLetters(value) {
      return value
        .split(/[\s,;]+/)
        .map(token => token.trim())
        .filter(Boolean);
    }

    function buildPool() {
      const pool = [];

      if (els.useLetters.checked) {
        pool.push(...parseLetters(els.lettersInput.value).map(v => v.toUpperCase()));
      }

      if (els.useWords.checked) {
        pool.push(...parseList(els.wordsInput.value));
      }

      if (els.useNumbers.checked) {
        const start = Number(els.numStart.value);
        const end = Number(els.numEnd.value);
        if (Number.isInteger(start) && Number.isInteger(end) && end >= start) {
          for (let n = start; n <= end; n += 1) {
            pool.push(String(n));
          }
        }
      }

      return unique(pool);
    }

    function shuffle(array) {
      const copy = [...array];
      for (let i = copy.length - 1; i > 0; i -= 1) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function escapeHTML(value) {
      return value
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/\"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function tokenKey(value) {
      return encodeURIComponent(value);
    }

    function cardHTML(symbols, cardKey) {
      const count = symbols.length;
      const slots = [];
      const hasCenter = count % 2 === 1;
      const ringTokens = hasCenter ? symbols.slice(1) : symbols;
      const radius = count <= 4 ? 31 : 35;

      for (let i = 0; i < ringTokens.length; i += 1) {
        const angle = (Math.PI * 2 * i) / ringTokens.length - Math.PI / 2;
        const x = 50 + Math.cos(angle) * radius;
        const y = 50 + Math.sin(angle) * radius;
        const rotate = Math.round((Math.random() - 0.5) * 20);
        const token = ringTokens[i];
        const key = tokenKey(token);
        slots.push(
          `<button type="button" class="token-btn" data-card="${cardKey}" data-token-key="${key}" style="left:${x}%;top:${y}%;--rot:${rotate}deg;transform:translate(-50%,-50%) rotate(${rotate}deg);">${escapeHTML(token)}</button>`
        );
      }

      if (hasCenter) {
        const center = symbols[0];
        const key = tokenKey(center);
        slots.push(
          `<button type="button" class="token-btn" data-card="${cardKey}" data-token-key="${key}" style="left:50%;top:50%;--rot:0deg;transform:translate(-50%,-50%);">${escapeHTML(center)}</button>`
        );
      }

      return `<div class="card" data-card="${cardKey}">${slots.join("")}</div>`;
    }

    function updateScoreboard() {
      els.roundsValue.textContent = String(state.rounds);
      els.correctValue.textContent = String(state.correct);
      const pct = state.rounds ? Math.round((state.correct / state.rounds) * 100) : 0;
      els.accuracyValue.textContent = `${pct}%`;
    }

    function renderPair() {
      els.pairMount.innerHTML = `
        <div class="card-shell" id="cardShellA">
          <div class="card-label">Card 1</div>
          ${cardHTML(state.cardA, "a")}
        </div>
        <div class="card-shell" id="cardShellB">
          <div class="card-label">Card 2</div>
          ${cardHTML(state.cardB, "b")}
        </div>
      `;

      const tokens = els.pairMount.querySelectorAll(".token-btn");
      tokens.forEach(tokenBtn => {
        tokenBtn.addEventListener("click", () => handleTokenClick(tokenBtn));
      });
    }

    function revealAnswer(clickedBtn, isCorrect) {
      const allButtons = [...els.pairMount.querySelectorAll(".token-btn")];
      allButtons.forEach(btn => {
        const answer = btn.dataset.tokenKey === state.matchTokenKey;
        if (answer) {
          btn.classList.add("correct");
        }
        if (!isCorrect && btn === clickedBtn) {
          btn.classList.add("missed");
        }
        btn.disabled = true;
      });

      const shellA = document.getElementById("cardShellA");
      const shellB = document.getElementById("cardShellB");
      if (shellA && shellB) {
        shellA.classList.add("correct");
        shellB.classList.add("correct");
      }
    }

    function handleTokenClick(button) {
      if (state.answered) return;
      state.answered = true;

      const isCorrect = button.dataset.tokenKey === state.matchTokenKey;

      if (isCorrect) {
        state.correct += 1;
        setStatus("Correct. You found the matching symbol.", "good");
      } else {
        setStatus("Not that one. The matching symbols are now highlighted.", "bad");
      }

      revealAnswer(button, isCorrect);
      updateScoreboard();
    }

    function dealRound() {
      const itemsPerCard = Number(els.itemsPerCard.value);
      const pool = buildPool();

      if (!Number.isInteger(itemsPerCard) || itemsPerCard < 3 || itemsPerCard > 8) {
        setStatus("Items per card must be a whole number from 3 to 8.", "bad");
        return;
      }

      const minimumPool = (itemsPerCard * 2) - 1;
      if (pool.length < minimumPool) {
        setStatus(`Need at least ${minimumPool} total symbols. Right now you have ${pool.length}.`, "bad");
        return;
      }

      const chosen = shuffle(pool).slice(0, minimumPool);
      const shared = chosen[0];
      const cardAOnly = chosen.slice(1, itemsPerCard);
      const cardBOnly = chosen.slice(itemsPerCard, minimumPool);
      state.matchTokenKey = tokenKey(shared);
      state.cardA = shuffle([shared, ...cardAOnly]);
      state.cardB = shuffle([shared, ...cardBOnly]);

      state.answered = false;
      state.rounds += 1;
      renderPair();
      updateScoreboard();
      setStatus("Round dealt. Click the one symbol that appears on both cards.", "");
    }

    els.dealBtn.addEventListener("click", dealRound);
    els.newRoundBtn.addEventListener("click", dealRound);
    els.printBtn.addEventListener("click", () => window.print());

    dealRound();
  </script>
</body>
</html>
