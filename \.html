<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Long Division Color-Coded Organizer Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --ink: #1d2430;
      --panel: #ffffff;
      --surface: #f4f6fa;
      --line: #171717;
      --soft-line: #8e98aa;
      --teal: #a9ddd3;
      --paper: #ffffff;
      --tone0-fill: rgba(190, 142, 220, 0.15);
      --tone1-fill: rgba(255, 200, 110, 0.15);
      --tone2-fill: rgba(145, 205, 230, 0.15);
      --tone3-fill: rgba(178, 220, 170, 0.15);
      --tone0-line: #c9a8df;
      --tone1-line: #f3c883;
      --tone2-line: #9ecbe2;
      --tone3-line: #b3d5a8;
      --tone0-strong: #e8c9f7;
      --tone1-strong: #ffe2b3;
      --tone2-strong: #d1ecf8;
      --tone3-strong: #dcefd5;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #f8f9fc 0%, #f1f3f7 55%, #edf0f5 100%);
      color: var(--ink);
      font-family: "Poppins", sans-serif;
    }

    .app {
      max-width: 1160px;
      margin: 0 auto;
      padding: 14px 14px 36px;
    }

    .screen-only h1 {
      margin: 2px 0 2px;
      font-size: clamp(1.3rem, 2.8vw, 2rem);
      line-height: 1.2;
      text-align: center;
      font-weight: 800;
      letter-spacing: 0.2px;
    }

    .screen-only .subtitle {
      margin: 0 0 12px;
      text-align: center;
      font-size: 0.95rem;
      color: #425066;
    }

    .controls-card {
      background: var(--panel);
      border: 2px solid #d9dfeb;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(33, 43, 63, 0.06);
      padding: 12px;
      margin-bottom: 12px;
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      align-items: end;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .field label {
      font-size: 0.78rem;
      font-weight: 700;
      letter-spacing: 0.2px;
      color: #43516a;
      text-transform: uppercase;
    }

    .field-hint {
      font-size: 0.78rem;
      color: #5a677f;
      line-height: 1.25;
    }

    .field select,
    .field input,
    .field textarea {
      font-family: inherit;
      border: 2px solid #cfd7e5;
      border-radius: 10px;
      background: #fff;
      color: var(--ink);
      font-size: 0.95rem;
      padding: 8px 10px;
      outline: none;
      width: 100%;
    }

    .field textarea {
      min-height: 64px;
      resize: vertical;
    }

    .checkbox-wrap {
      display: flex;
      align-items: center;
      gap: 8px;
      min-height: 42px;
      border: 2px solid #cfd7e5;
      border-radius: 10px;
      padding: 7px 10px;
      background: #fff;
      font-size: 0.9rem;
      font-weight: 600;
      color: #32415a;
    }

    .checkbox-wrap input {
      width: 16px;
      height: 16px;
      margin: 0;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .button-row button {
      border: 2px solid #1f2b3e;
      border-radius: 10px;
      background: #fff;
      color: #1f2b3e;
      font-size: 0.95rem;
      font-weight: 700;
      padding: 8px 16px;
      cursor: pointer;
    }

    .button-row button.primary {
      background: #1f2b3e;
      color: #fff;
    }

    .note {
      margin-top: 8px;
      font-size: 0.84rem;
      color: #5a677f;
    }

    #worksheetHost {
      margin-top: 12px;
    }

    .sheet {
      width: 8.5in;
      min-height: 11in;
      margin: 0 auto;
      background: var(--paper);
      border: 1px solid #d6dbe7;
      box-shadow: 0 12px 30px rgba(25, 35, 55, 0.1);
      padding: 0.3in;
      position: relative;
    }

    .sheet-header {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 2px solid #ced5e3;
      padding-bottom: 7px;
      margin-bottom: 10px;
    }

    .sheet-title {
      margin: 0;
      font-size: 1.03rem;
      font-weight: 800;
      line-height: 1.25;
    }

    .name-line {
      white-space: nowrap;
      font-size: 0.84rem;
      font-weight: 600;
    }

    .name-line .line {
      display: inline-block;
      width: 140px;
      border-bottom: 2px solid #111;
      transform: translateY(-2px);
      margin-left: 5px;
    }

    .organizer {
      border: 2px solid #111;
      border-radius: 5px;
      padding: 9px;
      display: grid;
      grid-template-columns: minmax(0, 0.96fr) minmax(0, 1.34fr);
      gap: 9px;
      min-height: 9.75in;
    }

    .left-column {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .problem-equation {
      font-size: 1.02rem;
      font-weight: 800;
      border: 2px solid #111;
      border-radius: 4px;
      padding: 4px 10px;
      text-align: center;
      background: #fff;
    }

    .workspace {
      border: 2px solid #111;
      border-radius: 4px;
      padding: 8px 7px 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: #fff;
    }

    .setup-row {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      justify-content: flex-start;
    }

    .digit-box {
      min-width: 36px;
      height: 36px;
      border: 2px solid #111;
      border-radius: 2px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 1.08rem;
      font-weight: 700;
      background: #fff;
    }

    .digit-box.small {
      min-width: 30px;
      height: 30px;
      font-size: 0.98rem;
    }

    .digit-box.divisor-fixed {
      background: var(--teal);
    }

    .bracket-block {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
    }

    .quotient-row {
      display: flex;
      gap: 4px;
      padding-left: 13px;
    }

    .dividend-row-wrap {
      display: flex;
      align-items: stretch;
      gap: 5px;
    }

    .bracket-stem {
      width: 10px;
      border-left: 4px solid #111;
      margin-top: 3px;
    }

    .dividend-row {
      display: flex;
      gap: 4px;
      padding-top: 5px;
      border-top: 4px solid #111;
    }

    .remainder-wrap {
      display: flex;
      align-items: center;
      gap: 4px;
      font-weight: 700;
      font-size: 1.12rem;
      margin-left: 2px;
      padding-bottom: 3px;
    }

    .step-panels {
      display: grid;
      grid-template-columns: repeat(var(--step-count), minmax(0, 1fr));
      gap: 5px;
    }

    .step-panel {
      border: 2px solid #111;
      border-radius: 3px;
      padding: 5px 4px;
      position: relative;
      min-height: 118px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      background: #fff;
      overflow: visible;
    }

    .step-panel:not(:last-child)::after {
      content: "➜";
      position: absolute;
      right: -13px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.15rem;
      font-weight: 800;
      line-height: 1;
      z-index: 2;
      color: #111;
    }

    .step-title {
      width: 100%;
      text-align: center;
      font-size: 0.66rem;
      font-weight: 800;
      letter-spacing: 0.2px;
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .minus-line {
      width: 88%;
      border-bottom: 4px solid #111;
      position: relative;
      margin: 2px 0;
      min-height: 8px;
    }

    .minus-line::before {
      content: "−";
      position: absolute;
      left: -12px;
      top: -13px;
      font-size: 1.4rem;
      font-weight: 700;
      line-height: 1;
    }

    .checklist-box {
      border: 2px solid #111;
      border-radius: 4px;
      padding: 7px 8px;
      background: #fff;
    }

    .checklist-title {
      margin: 0 0 6px;
      font-size: 0.82rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.2px;
      border-bottom: 2px solid #111;
      padding-bottom: 3px;
    }

    .steps-list {
      margin: 0;
      padding: 0;
      list-style: none;
      font-size: 0.85rem;
      line-height: 1.3;
      columns: 1;
    }

    .steps-list li {
      display: flex;
      align-items: center;
      gap: 4px;
      min-height: 1.08rem;
    }

    .checkbox-char {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 0.95rem;
      font-size: 0.9rem;
      line-height: 1;
    }

    .right-column {
      display: flex;
      flex-direction: column;
      gap: 7px;
    }

    .strip {
      border: 2px solid #111;
      border-radius: 4px;
      padding: 6px 7px;
      background: #fff;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .strip-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .strip-label {
      font-size: 0.75rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.2px;
      border: 2px solid #111;
      border-radius: 3px;
      padding: 1px 7px;
      background: #fff;
      flex: 0 0 auto;
    }

    .strip-question {
      margin: 0;
      display: flex;
      align-items: center;
      gap: 3px;
      flex-wrap: wrap;
      font-size: 0.86rem;
      font-weight: 700;
      line-height: 1.25;
    }

    .target-digits {
      display: inline-flex;
      gap: 2px;
      align-items: center;
    }

    .strip-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .strip-table th,
    .strip-table td {
      border: 1px solid #111;
      text-align: center;
      height: 29px;
      font-size: 0.79rem;
      font-weight: 700;
      padding: 0;
    }

    .strip-table th.tone-head.tone-0 { background: var(--tone0-strong); }
    .strip-table th.tone-head.tone-1 { background: var(--tone1-strong); }
    .strip-table th.tone-head.tone-2 { background: var(--tone2-strong); }
    .strip-table th.tone-head.tone-3 { background: var(--tone3-strong); }

    .multiple-cell {
      position: relative;
      background: #fff;
    }

    .multiple-cell.blank::after {
      content: "";
      position: absolute;
      left: 14%;
      right: 14%;
      bottom: 5px;
      border-bottom: 2px solid #111;
    }

    .tone-0-bg { background: var(--tone0-fill); }
    .tone-1-bg { background: var(--tone1-fill); }
    .tone-2-bg { background: var(--tone2-fill); }
    .tone-3-bg { background: var(--tone3-fill); }

    .color-fill .tone-0 {
      background: var(--tone0-fill);
    }

    .color-fill .tone-1 {
      background: var(--tone1-fill);
    }

    .color-fill .tone-2 {
      background: var(--tone2-fill);
    }

    .color-fill .tone-3 {
      background: var(--tone3-fill);
    }

    .color-line .tone-0 {
      box-shadow: inset 0 0 0 3px var(--tone0-line);
    }

    .color-line .tone-1 {
      box-shadow: inset 0 0 0 3px var(--tone1-line);
    }

    .color-line .tone-2 {
      box-shadow: inset 0 0 0 3px var(--tone2-line);
    }

    .color-line .tone-3 {
      box-shadow: inset 0 0 0 3px var(--tone3-line);
    }

    .no-color .tone-0,
    .no-color .tone-1,
    .no-color .tone-2,
    .no-color .tone-3 {
      background: #fff !important;
      box-shadow: none !important;
      border-color: #111 !important;
    }

    .no-color .strip-table th.tone-head {
      background: #efefef !important;
    }

    .footer-note {
      position: absolute;
      left: 0.3in;
      right: 0.3in;
      bottom: 0.16in;
      text-align: left;
      font-size: 0.64rem;
      color: #6a7485;
    }

    @media (max-width: 980px) {
      .sheet {
        width: 100%;
        min-height: 0;
        padding: 12px;
      }

      .organizer {
        min-height: 0;
        grid-template-columns: 1fr;
      }

      .footer-note {
        position: static;
        margin-top: 8px;
      }
    }

    @media print {
      @page {
        size: Letter;
        margin: 0.28in;
      }

      body {
        background: #fff;
      }

      .screen-only {
        display: none !important;
      }

      .app {
        margin: 0;
        max-width: none;
        padding: 0;
      }

      #worksheetHost {
        margin: 0;
      }

      .sheet {
        width: auto;
        min-height: 0;
        margin: 0;
        border: 0;
        box-shadow: none;
        padding: 0;
      }

      .organizer {
        min-height: 9.95in;
      }

      .footer-note {
        position: fixed;
        left: 0.28in;
        right: 0.28in;
        bottom: 0.1in;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="screen-only">
      <h1>Long Division Color-Coded Organizer Generator</h1>
      <p class="subtitle">Your right-side step-strip format with matching color logic</p>

      <section class="controls-card">
        <div class="controls-grid">
          <div class="field">
            <label for="problemType">Problem Type</label>
            <select id="problemType">
              <option value="2x1" selected>2-digit dividend / 1-digit divisor</option>
              <option value="3x1">3-digit dividend / 1-digit divisor</option>
              <option value="4x1">4-digit dividend / 1-digit divisor</option>
            </select>
          </div>

          <div class="field">
            <label for="problemMode">Problem Source</label>
            <select id="problemMode">
              <option value="random" selected>Random problem</option>
              <option value="custom">Custom problem (use textbox)</option>
            </select>
          </div>

          <div class="field">
            <label for="customProblem">Custom Problem</label>
            <input id="customProblem" type="text" placeholder="Examples: 654/6 or 6)654" />
            <div class="field-hint">Single problem only for this organizer page.</div>
          </div>

          <div class="field">
            <label for="multiplesMode">Multiples Mode</label>
            <select id="multiplesMode">
              <option value="blank" selected>Blank (students fill in)</option>
              <option value="filled">Filled multiples</option>
            </select>
          </div>

          <div class="field">
            <label>Color Coding</label>
            <label class="checkbox-wrap"><input id="colorToggle" type="checkbox" checked />Use matching colors</label>
          </div>

          <div class="field">
            <label for="colorStyle">Color Style</label>
            <select id="colorStyle">
              <option value="fill" selected>Inside Fill (light)</option>
              <option value="line">Line/Outline Only</option>
            </select>
          </div>

          <div class="field">
            <label>Answer Key View</label>
            <label class="checkbox-wrap"><input id="answerKeyToggle" type="checkbox" />Prefill quotient + step boxes</label>
          </div>

          <div class="field">
            <label for="sheetTitle">Worksheet Title</label>
            <input id="sheetTitle" type="text" value="Long Division Color-Coded Step Organizer" />
          </div>
        </div>

        <div class="button-row">
          <button id="generateBtn" class="primary" type="button">Generate</button>
          <button id="printBtn" type="button">Print</button>
        </div>

        <div class="note" id="statusText">Tip: use blank multiples for regular student practice and filled multiples for targeted support.</div>
      </section>
    </div>

    <div id="worksheetHost"></div>
  </div>

  <script>
    const els = {
      host: document.getElementById("worksheetHost"),
      problemType: document.getElementById("problemType"),
      problemMode: document.getElementById("problemMode"),
      customProblem: document.getElementById("customProblem"),
      multiplesMode: document.getElementById("multiplesMode"),
      colorToggle: document.getElementById("colorToggle"),
      colorStyle: document.getElementById("colorStyle"),
      answerKeyToggle: document.getElementById("answerKeyToggle"),
      sheetTitle: document.getElementById("sheetTitle"),
      statusText: document.getElementById("statusText"),
      generateBtn: document.getElementById("generateBtn"),
      printBtn: document.getElementById("printBtn")
    };

    const TYPE_CONFIG = {
      "2x1": { digits: 2, dividendMin: 10, dividendMax: 99, label: "2-digit by 1-digit" },
      "3x1": { digits: 3, dividendMin: 100, dividendMax: 999, label: "3-digit by 1-digit" },
      "4x1": { digits: 4, dividendMin: 1000, dividendMax: 9999, label: "4-digit by 1-digit" }
    };

    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function getTypeConfig() {
      return TYPE_CONFIG[els.problemType.value] || TYPE_CONFIG["2x1"];
    }

    function parseProblemToken(token, cfg) {
      const clean = token.trim().replace(/\s+/g, "");
      if (!clean) return null;

      let dividend = null;
      let divisor = null;

      const slashMatch = clean.match(/^(\d+)(?:\/|÷)(\d+)$/);
      if (slashMatch) {
        dividend = Number(slashMatch[1]);
        divisor = Number(slashMatch[2]);
      }

      const bracketMatch = clean.match(/^(\d+)\)(\d+)$/);
      if (bracketMatch) {
        divisor = Number(bracketMatch[1]);
        dividend = Number(bracketMatch[2]);
      }

      if (!Number.isFinite(dividend) || !Number.isFinite(divisor)) return null;
      if (divisor < 2 || divisor > 9) return null;
      if (dividend < cfg.dividendMin || dividend > cfg.dividendMax) return null;
      return { dividend, divisor };
    }

    function makeRandomProblem(cfg) {
      return {
        dividend: randInt(cfg.dividendMin, cfg.dividendMax),
        divisor: randInt(2, 9)
      };
    }

    function getProblem(cfg) {
      if (els.problemMode.value === "custom") {
        const parsed = parseProblemToken(els.customProblem.value, cfg);
        if (!parsed) {
          return {
            problem: null,
            warning: true,
            message: "Invalid custom problem. Use examples like 654/6 or 6)654."
          };
        }
        return { problem: parsed, warning: false, message: "Generated custom organizer." };
      }
      return { problem: makeRandomProblem(cfg), warning: false, message: "Generated random organizer." };
    }

    function toneClass(index) {
      return `tone-${index % 4}`;
    }

    function computeLongDivisionSteps(dividend, divisor) {
      const digits = String(dividend).split("").map((d) => Number(d));
      const steps = [];
      let current = 0;

      for (let i = 0; i < digits.length; i += 1) {
        current = (current * 10) + digits[i];
        const qDigit = Math.floor(current / divisor);
        const product = qDigit * divisor;
        const remainder = current - product;
        const nextDigit = i < digits.length - 1 ? digits[i + 1] : null;
        const nextPartial = nextDigit === null ? remainder : (remainder * 10) + nextDigit;

        steps.push({
          index: i,
          tone: toneClass(i),
          partialDividend: current,
          quotientDigit: qDigit,
          product,
          remainder,
          nextDigit,
          nextPartial
        });

        current = remainder;
      }

      return {
        steps,
        quotientDigits: steps.map((s) => s.quotientDigit),
        finalRemainder: current
      };
    }

    function buildChecklist(stepCount) {
      const actions = ["Divide", "Multiply", "Subtract"];
      for (let i = 1; i < stepCount; i += 1) {
        actions.push("Bring Down", "Divide", "Multiply", "Subtract");
      }
      return actions;
    }

    function digitBoxesForValue(value, tone, small = true) {
      const chars = String(value).split("");
      return chars.map((ch) => `<span class="digit-box ${small ? "small" : ""} ${tone}">${ch}</span>`).join("");
    }

    function renderSetup(problem, stepsData, showAnswers) {
      const dividendDigits = String(problem.dividend).split("");
      const quotientBoxes = stepsData.quotientDigits.map((digit, idx) => {
        const content = showAnswers ? digit : "&nbsp;";
        return `<span class="digit-box ${toneClass(idx)}">${content}</span>`;
      }).join("");

      const dividendBoxes = dividendDigits.map((digit, idx) => {
        return `<span class="digit-box ${toneClass(idx)}">${digit}</span>`;
      }).join("");

      return `
        <div class="setup-row">
          <span class="digit-box divisor-fixed">${problem.divisor}</span>

          <div class="bracket-block">
            <div class="quotient-row">
              ${quotientBoxes}
            </div>
            <div class="dividend-row-wrap">
              <span class="bracket-stem"></span>
              <div class="dividend-row">
                ${dividendBoxes}
              </div>
            </div>
          </div>

          <div class="remainder-wrap">
            <span>r</span>
            <span class="digit-box">${showAnswers ? stepsData.finalRemainder : "&nbsp;"}</span>
          </div>
        </div>
      `;
    }

    function renderStepPanels(steps, showAnswers) {
      const panels = steps.map((step, idx) => `
        <div class="step-panel">
          <div class="step-title">Step ${idx + 1}</div>
          <span class="digit-box small ${step.tone}">${showAnswers ? step.product : "&nbsp;"}</span>
          <div class="minus-line"></div>
          <span class="digit-box small ${step.tone}">${showAnswers ? step.remainder : "&nbsp;"}</span>
          <span class="digit-box small ${step.tone}">${showAnswers && step.nextDigit !== null ? step.nextPartial : "&nbsp;"}</span>
        </div>
      `).join("");

      return `<div class="step-panels" style="--step-count:${steps.length};">${panels}</div>`;
    }

    function renderChecklist(steps) {
      const checklist = buildChecklist(steps.length);
      const items = checklist.map((label, idx) => `
        <li><span class="checkbox-char">&#x2610;</span> ${idx + 1}. ${label}</li>
      `).join("");

      return `
        <div class="checklist-box">
          <h3 class="checklist-title">Steps</h3>
          <ul class="steps-list">${items}</ul>
        </div>
      `;
    }

    function renderMultipleCells(divisor, mode, tone) {
      let cells = "";
      for (let i = 0; i <= 10; i += 1) {
        const value = mode === "filled" ? String(divisor * i) : "&nbsp;";
        const blankClass = mode === "blank" ? "blank" : "";
        cells += `<td class="multiple-cell ${tone} ${blankClass}">${value}</td>`;
      }
      return cells;
    }

    function renderStepStrip(step, problem, multiplesMode) {
      const headers = new Array(11).fill(0).map((_, i) => `<th class="tone-head ${step.tone}">x${i}</th>`).join("");

      return `
        <section class="strip">
          <div class="strip-head">
            <div class="strip-label ${step.tone}">Step ${step.index + 1}</div>
            <p class="strip-question">
              How many times does
              <span class="digit-box small divisor-fixed">${problem.divisor}</span>
              go into
              <span class="target-digits">${digitBoxesForValue(step.partialDividend, step.tone, true)}</span>
              evenly or without going over?
            </p>
          </div>

          <table class="strip-table" aria-label="Step multiples strip">
            <thead>
              <tr>${headers}</tr>
            </thead>
            <tbody>
              <tr>${renderMultipleCells(problem.divisor, multiplesMode, step.tone)}</tr>
            </tbody>
          </table>
        </section>
      `;
    }

    function renderWorksheet() {
      const cfg = getTypeConfig();
      const source = getProblem(cfg);
      const title = els.sheetTitle.value.trim() || "Long Division Color-Coded Step Organizer";
      const colorClass = els.colorToggle.checked ? `color-${els.colorStyle.value}` : "no-color";

      els.statusText.textContent = source.message;
      els.statusText.style.color = source.warning ? "#a33a3a" : "#5a677f";

      if (!source.problem) {
        els.host.innerHTML = "";
        return;
      }

      const showAnswers = els.answerKeyToggle.checked;
      const stepsData = computeLongDivisionSteps(source.problem.dividend, source.problem.divisor);
      const strips = stepsData.steps.map((step) => renderStepStrip(step, source.problem, els.multiplesMode.value)).join("");

      els.host.innerHTML = `
        <section class="sheet ${colorClass}">
          <header class="sheet-header">
            <h2 class="sheet-title">${title} (${cfg.label})</h2>
            <div class="name-line">Name:<span class="line"></span></div>
          </header>

          <section class="organizer">
            <section class="left-column">
              <div class="problem-equation">${source.problem.dividend} &divide; ${source.problem.divisor} =</div>
              <div class="workspace">
                ${renderSetup(source.problem, stepsData, showAnswers)}
                ${renderStepPanels(stepsData.steps, showAnswers)}
              </div>
              ${renderChecklist(stepsData.steps)}
            </section>

            <section class="right-column">
              ${strips}
            </section>
          </section>

          <div class="footer-note">Color-coded organizer: right-side strips are aligned to each long-division step.</div>
        </section>
      `;
    }

    els.generateBtn.addEventListener("click", renderWorksheet);
    els.printBtn.addEventListener("click", () => window.print());

    renderWorksheet();
  </script>
</body>
</html>
