<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Long Division Mainstream Organizer Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      --ink: #000;
      --paper: #fff;
      --line: #000;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      background: #fff;
      color: var(--ink);
      font-family: "Poppins", sans-serif;
    }

    .app {
      max-width: 1160px;
      margin: 0 auto;
      padding: 14px 14px 28px;
    }

    .screen-only h1 {
      margin: 0;
      text-align: center;
      font-size: clamp(1.3rem, 2.8vw, 2rem);
      font-weight: 800;
      letter-spacing: 0.1px;
    }

    .subtitle {
      margin: 4px 0 12px;
      text-align: center;
      font-size: 0.95rem;
      color: #000;
    }

    .controls-card {
      border: 2px solid #000;
      background: #fff;
      padding: 12px;
      margin-bottom: 12px;
    }

    .type-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 10px;
    }

    .type-btn {
      border: 2px solid #000;
      background: #fff;
      color: #000;
      padding: 8px;
      font: inherit;
      font-size: 0.92rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.2px;
      cursor: pointer;
    }

    .type-btn.active {
      background: #000;
      color: #fff;
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 10px;
      align-items: end;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .field label {
      font-size: 0.78rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.2px;
      color: #000;
    }

    .field-hint {
      font-size: 0.78rem;
      line-height: 1.2;
      color: #000;
    }

    .field select,
    .field input,
    .field textarea {
      width: 100%;
      border: 2px solid #000;
      background: #fff;
      color: #000;
      font: inherit;
      font-size: 0.95rem;
      padding: 8px 10px;
      outline: none;
    }

    .field textarea {
      min-height: 62px;
      resize: vertical;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .button-row button {
      border: 2px solid #000;
      background: #fff;
      color: #000;
      font: inherit;
      font-size: 0.95rem;
      font-weight: 700;
      padding: 8px 16px;
      cursor: pointer;
    }

    .note {
      margin-top: 8px;
      font-size: 0.84rem;
      color: #000;
    }

    #worksheetHost { margin-top: 12px; }

    .sheet {
      width: 8.5in;
      min-height: 11in;
      margin: 0 auto;
      background: var(--paper);
      border: 2px solid #000;
      padding: 0.14in 0.14in 0.28in;
      position: relative;
    }

    .sheet-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 10px;
      border-bottom: 2px solid #000;
      padding-bottom: 4px;
      margin-bottom: 10px;
    }

    .sheet-title {
      margin: 0;
      font-size: 1.04rem;
      font-weight: 800;
      text-transform: uppercase;
      line-height: 1.2;
    }

    .name-line {
      white-space: nowrap;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .name-line .line {
      display: inline-block;
      width: 100px;
      border-bottom: 2px solid #000;
      transform: translateY(-2px);
      margin-left: 5px;
    }

    .problem-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      align-items: start;
    }

    .problem-card {
      min-height: 3.1in;
      display: flex;
      flex-direction: column;
      break-inside: avoid;
      page-break-inside: avoid;
      border: 2px solid #000;
      padding: 5px;
    }

    .problem-main {
      display: grid;
      grid-template-columns: 104px minmax(0, 1fr);
      gap: 6px;
      min-height: 0;
      flex: 1 1 auto;
      align-items: start;
    }

    .multiples-panel {
      border: 2px solid #000;
      background: #fff;
      display: flex;
      flex-direction: column;
      align-self: start;
    }

    .multiples-head {
      border-bottom: 2px solid #000;
      text-align: center;
      font-size: 0.74rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.2px;
      padding: 3px 1px;
    }

    .multiples-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .multiples-table td {
      border-top: 2px solid #000;
      text-align: center;
      height: 24px;
      padding: 2px;
    }

    .multiples-table td:first-child {
      width: 44%;
      border-right: 2px solid #000;
    }

    .problem-panel {
      display: flex;
      align-items: flex-start;
      padding-top: 2px;
      border: 2px solid #000;
      background: #fff;
      padding: 4px;
    }

    .sheet.layout-4 .problem-grid {
      gap: 10px;
    }

    .sheet.layout-4 .problem-card {
      min-height: 4.2in;
      padding: 7px;
    }

    .sheet.layout-4 .problem-main {
      grid-template-columns: 122px minmax(0, 1fr);
      gap: 8px;
    }

    .sheet.layout-4 .multiples-head {
      font-size: 0.8rem;
      padding: 4px 2px;
    }

    .sheet.layout-4 .multiples-table {
      font-size: 0.9rem;
    }

    .sheet.layout-4 .multiples-table td {
      height: 29px;
    }

    .ld-table-wrap {
      --cell-w: 38px;
      --cell-h: 27px;
      --cell-font: 1.2rem;
      --minus-w: 22px;
      --minus-font: 1.4rem;
      width: fit-content;
    }

    .ld-table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    .ld-table td {
      width: var(--cell-w);
      height: var(--cell-h);
      padding: 0;
      text-align: center;
      vertical-align: middle;
      font-size: var(--cell-font);
      font-weight: 700;
      line-height: 1;
    }

    .ld-minus-col {
      width: var(--minus-w) !important;
      min-width: var(--minus-w);
      max-width: var(--minus-w);
    }

    .ld-pad {
      border: 0;
      background: transparent;
    }

    .ld-box {
      border: 2px solid #000;
      background: #fff;
    }

    .ld-minus-mark {
      border: 0;
      background: transparent;
      font-size: var(--minus-font);
      font-weight: 800;
      line-height: 1;
      text-align: right;
      padding-right: 2px;
    }

    .ld-rem-label {
      border: 0;
      background: transparent;
      font-weight: 800;
      font-size: calc(var(--cell-font) * 0.82);
      width: 18px !important;
      min-width: 18px;
      max-width: 18px;
      text-align: center;
      line-height: 1;
    }

    .ld-dividend-top {
      border-top: 4px solid #000 !important;
    }

    .ld-bracket-left {
      border-left: 4px solid #000 !important;
    }

    .ld-line-under {
      border-bottom: 4px solid #000 !important;
    }

    .footer-note {
      margin-top: 8px;
      padding-top: 5px;
      border-top: 2px solid #000;
      text-align: left;
      font-size: 0.6rem;
      font-weight: 600;
      color: #000;
      line-height: 1.15;
    }

    @media screen and (max-width: 980px) {
      .sheet {
        width: 100%;
        min-height: 0;
        padding: 12px;
      }

      .problem-grid { grid-template-columns: 1fr; }
      .problem-card { min-height: 0; }
    }

    @media print {
      @page {
        size: Letter;
        margin: 0.25in;
      }

      body { background: #fff; }
      .screen-only { display: none !important; }

      .app {
        margin: 0;
        max-width: none;
        padding: 0;
      }

      #worksheetHost { margin: 0; }

      .sheet {
        width: auto;
        min-height: 0;
        margin: 0;
        border: 0;
        padding: 0;
        page-break-inside: avoid;
        break-inside: avoid;
      }

      .problem-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
        gap: 6px;
      }

      .problem-card {
        min-height: 2.98in;
        border: 2px solid #000;
        padding: 5px;
      }

      .problem-main {
        grid-template-columns: 102px minmax(0, 1fr);
        gap: 5px;
      }

      .multiples-head {
        font-size: 0.7rem;
        padding: 3px 1px;
      }

      .multiples-table {
        font-size: 0.74rem;
      }

      .multiples-table td {
        height: 22px;
      }

      .footer-note {
        margin-top: 6px;
        padding-top: 4px;
        border-top: 2px solid #000;
        font-size: 0.56rem;
      }

      .sheet.layout-4 .problem-grid {
        gap: 6px;
      }

      .sheet.layout-4 .problem-card {
        min-height: 4.28in;
        padding: 8px;
      }

      .sheet.layout-4 .problem-main {
        grid-template-columns: 126px minmax(0, 1fr);
        gap: 8px;
      }

      .sheet.layout-4 .multiples-head {
        font-size: 0.78rem;
        padding: 4px 2px;
      }

      .sheet.layout-4 .multiples-table {
        font-size: 0.84rem;
      }

      .sheet.layout-4 .multiples-table td {
        height: 27px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="screen-only">
      <h1>Long Division Mainstream Organizer Generator</h1>
      <p class="subtitle">2 by 1 prints 6-up, 3 by 1 and 4 by 1 print 4-up with larger writing space</p>

      <section class="controls-card">
        <div class="type-row" id="typeButtons" role="group" aria-label="Problem type">
          <button type="button" class="type-btn active" data-type="2x1">2 by 1</button>
          <button type="button" class="type-btn" data-type="3x1">3 by 1</button>
          <button type="button" class="type-btn" data-type="4x1">4 by 1</button>
        </div>
        <input id="problemType" type="hidden" value="2x1" />

        <div class="controls-grid">
          <div class="field">
            <label for="problemMode">Problem Source</label>
            <select id="problemMode">
              <option value="random" selected>Random problems</option>
              <option value="custom">Custom list (use textbox)</option>
            </select>
          </div>

          <div class="field">
            <label for="templateMode">Worksheet Mode</label>
            <select id="templateMode">
              <option value="normal" selected>Normal (numbers shown)</option>
              <option value="blank">Blank template</option>
            </select>
          </div>

          <div class="field">
            <label for="remainderMode">Remainders</label>
            <select id="remainderMode">
              <option value="without" selected>No remainders</option>
              <option value="with">Remainders</option>
              <option value="mixed">Mixed</option>
            </select>
          </div>

          <div class="field">
            <label for="multiplesMode">Multiples Mode</label>
            <select id="multiplesMode">
              <option value="blank" selected>Blank (students fill in)</option>
              <option value="filled">Filled multiples</option>
            </select>
          </div>

          <div class="field">
            <label for="sheetTitle">Worksheet Title</label>
            <input id="sheetTitle" type="text" value="Long Division Practice Organizer" />
          </div>

          <div class="field">
            <label for="customProblems">Custom Problems</label>
            <textarea id="customProblems" placeholder="Examples: 482/3, 3)654, 297รท9"></textarea>
            <div class="field-hint">Use comma, semicolon, or line break between problems.</div>
          </div>
        </div>

        <div class="button-row">
          <button id="generateBtn" type="button">Generate</button>
          <button id="printBtn" type="button">Print</button>
        </div>

        <div class="note" id="statusText">Ready. Layout matches the mainstream organizer format.</div>
      </section>
    </div>

    <div id="worksheetHost"></div>
  </div>

  <script>
    const els = {
      host: document.getElementById("worksheetHost"),
      problemType: document.getElementById("problemType"),
      typeButtons: Array.from(document.querySelectorAll(".type-btn")),
      problemMode: document.getElementById("problemMode"),
      templateMode: document.getElementById("templateMode"),
      remainderMode: document.getElementById("remainderMode"),
      multiplesMode: document.getElementById("multiplesMode"),
      sheetTitle: document.getElementById("sheetTitle"),
      customProblems: document.getElementById("customProblems"),
      statusText: document.getElementById("statusText"),
      generateBtn: document.getElementById("generateBtn"),
      printBtn: document.getElementById("printBtn")
    };

    const TYPE_CONFIG = {
      "2x1": { digits: 2, min: 10, max: 99, label: "2-digit by 1-digit", cardCount: 6 },
      "3x1": { digits: 3, min: 100, max: 999, label: "3-digit by 1-digit", cardCount: 4 },
      "4x1": { digits: 4, min: 1000, max: 9999, label: "4-digit by 1-digit", cardCount: 4 }
    };

    function getCardCount(cfg) {
      return Number.isFinite(cfg.cardCount) ? cfg.cardCount : 6;
    }

    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function getTypeConfig() {
      return TYPE_CONFIG[els.problemType.value] || TYPE_CONFIG["2x1"];
    }

    function setProblemType(typeKey) {
      if (!TYPE_CONFIG[typeKey]) return;
      els.problemType.value = typeKey;
      els.typeButtons.forEach((btn) => {
        btn.classList.toggle("active", btn.dataset.type === typeKey);
      });
    }

    function parseProblemToken(token, cfg) {
      const clean = token.trim().replace(/\s+/g, "");
      if (!clean) return null;

      let dividend = null;
      let divisor = null;

      const slashMatch = clean.match(/^(\d+)(?:\/|รท)(\d+)$/);
      if (slashMatch) {
        dividend = Number(slashMatch[1]);
        divisor = Number(slashMatch[2]);
      }

      const bracketMatch = clean.match(/^(\d+)\)(\d+)$/);
      if (bracketMatch) {
        divisor = Number(bracketMatch[1]);
        dividend = Number(bracketMatch[2]);
      }

      if (!Number.isFinite(dividend) || !Number.isFinite(divisor)) return null;
      if (divisor < 2 || divisor > 9) return null;
      if (dividend < cfg.min || dividend > cfg.max) return null;

      return { dividend, divisor };
    }

    function parseCustomProblems(raw, cfg) {
      const chunks = raw.split(/[\n,;]+/).map((s) => s.trim()).filter(Boolean);
      const valid = [];
      const invalid = [];

      for (const chunk of chunks) {
        const parsed = parseProblemToken(chunk, cfg);
        if (parsed) valid.push(parsed);
        else invalid.push(chunk);
      }

      return { valid, invalid };
    }

    function matchesRemainderMode(problem, remainderMode) {
      const rem = problem.dividend % problem.divisor;
      if (remainderMode === "with") return rem !== 0;
      if (remainderMode === "without") return rem === 0;
      return true;
    }

    function makeRandomProblem(cfg, remainderMode) {
      for (let tries = 0; tries < 4000; tries += 1) {
        const divisor = randInt(2, 9);
        const firstDigit = randInt(1, divisor - 1);
        let rest = "";
        for (let i = 1; i < cfg.digits; i += 1) {
          rest += String(randInt(0, 9));
        }
        const dividend = Number(`${firstDigit}${rest}`);
        if (dividend < cfg.min || dividend > cfg.max) continue;
        const problem = { dividend, divisor };
        if (!matchesRemainderMode(problem, remainderMode)) continue;
        return problem;
      }

      for (let divisor = 2; divisor <= 9; divisor += 1) {
        for (let dividend = cfg.min; dividend <= cfg.max; dividend += 1) {
          const firstDigit = Number(String(dividend)[0]);
          const problem = { dividend, divisor };
          if (firstDigit >= divisor) continue;
          if (!matchesRemainderMode(problem, remainderMode)) continue;
          return problem;
        }
      }

      return { dividend: cfg.min, divisor: 2 };
    }

    function hasInitialZeroStep(problem) {
      const firstDigit = Number(String(problem.dividend)[0]);
      return Number.isFinite(firstDigit) && firstDigit < problem.divisor;
    }

    function buildProblems(cfg, cardCount, remainderMode) {
      if (els.problemMode.value === "custom") {
        const parsed = parseCustomProblems(els.customProblems.value, cfg);
        const eligible = parsed.valid.filter((p) => (
          hasInitialZeroStep(p) && matchesRemainderMode(p, remainderMode)
        ));
        if (!eligible.length) {
          const remainderHint = remainderMode === "with" ? " with remainders" : " without remainders";
          return {
            problems: [],
            warning: true,
            message: `No valid custom problems for ${cfg.label}${remainderHint}. Use first digit < divisor (example: 482/5).`
          };
        }

        const picked = [];
        for (let i = 0; i < cardCount; i += 1) {
          picked.push({ ...eligible[i % eligible.length] });
        }

        const filteredOutCount = parsed.valid.length - eligible.length;
        const invalidNote = parsed.invalid.length ? ` Ignored: ${parsed.invalid.join(", ")}.` : "";
        const filteredNote = filteredOutCount > 0
          ? ` Ignored ${filteredOutCount} custom problem(s) that do not match setup/remainder settings.`
          : "";
        return {
          problems: picked,
          warning: parsed.invalid.length > 0 || filteredOutCount > 0,
          message: `Generated ${cardCount} custom ${cfg.label} problems.${filteredNote}${invalidNote}`
        };
      }

      const problems = [];
      const seen = new Set();
      let tries = 0;
      const modeTargets = remainderMode === "mixed"
        ? Array.from({ length: cardCount }, (_, i) => (i % 2 === 0 ? "with" : "without"))
        : null;

      while (problems.length < cardCount && tries < 4000) {
        const targetMode = modeTargets ? modeTargets[problems.length] : remainderMode;
        const p = makeRandomProblem(cfg, targetMode);
        const key = `${p.dividend}/${p.divisor}`;
        tries += 1;
        if (seen.has(key)) continue;
        seen.add(key);
        problems.push(p);
      }

      return {
        problems,
        warning: false,
        message: `Generated ${problems.length} random ${cfg.label} problems.`
      };
    }

    function multiplesRowsHtml(divisor, mode, blankTemplate) {
      let rows = "";
      for (let i = 1; i <= 9; i += 1) {
        const value = blankTemplate
          ? "&nbsp;"
          : (mode === "filled" ? String(divisor * i) : "&nbsp;");
        rows += `<tr><td>x${i}</td><td>${value}</td></tr>`;
      }
      return rows;
    }

    function longDivisionGridHtml(problem, cfg, blankTemplate, cardCount, showRemainderBox) {
      const n = cfg.digits;
      const digits = String(problem.dividend).split("");
      const rows = [];

      const td = (content, cls) => `<td class="${cls}">${content}</td>`;

      let row = `<tr>${td("&nbsp;", "ld-pad ld-minus-col")}${td("&nbsp;", "ld-pad")}`;
      for (let i = 0; i < n; i += 1) row += td("&nbsp;", "ld-box");
      if (showRemainderBox) {
        row += td("R", "ld-rem-label");
        row += td("&nbsp;", "ld-box");
      }
      row += "</tr>";
      rows.push(row);

      row = `<tr>${td("&nbsp;", "ld-pad ld-minus-col")}${td(blankTemplate ? "&nbsp;" : problem.divisor, "ld-box")}`;
      for (let i = 0; i < n; i += 1) {
        row += td(blankTemplate ? "&nbsp;" : digits[i], `ld-box ld-dividend-top${i === 0 ? " ld-bracket-left" : ""}`);
      }
      if (showRemainderBox) {
        row += td("&nbsp;", "ld-pad");
        row += td("&nbsp;", "ld-pad");
      }
      row += "</tr>";
      rows.push(row);

      const totalCols = n + 2 + (showRemainderBox ? 2 : 0);

      for (let i = 0; i < n; i += 1) {
        const startDigit = i === 0 ? 0 : Math.min(i - 1, n - 2);
        const startCol = 2 + startDigit;
        const productLen = i === 0 ? 1 : 2;
        const bringStart = i < n - 1
          ? 2 + Math.min(startDigit + (productLen - 1), n - 2)
          : startCol;

        let sub = "<tr>";
        for (let c = 0; c < totalCols; c += 1) {
          if (c === 0) sub += td("&nbsp;", "ld-pad ld-minus-col");
          else if (c === 1) sub += td("&minus;", "ld-minus-mark");
          else if (c >= startCol && c < startCol + productLen) sub += td("&nbsp;", "ld-box ld-line-under");
          else sub += td("&nbsp;", "ld-pad");
        }
        sub += "</tr>";
        rows.push(sub);

        let bring = "<tr>";
        for (let c = 0; c < totalCols; c += 1) {
          if (c <= 1) bring += td("&nbsp;", c === 0 ? "ld-pad ld-minus-col" : "ld-pad");
          else if (c >= bringStart && c < bringStart + 2) bring += td("&nbsp;", "ld-box");
          else bring += td("&nbsp;", "ld-pad");
        }
        bring += "</tr>";
        rows.push(bring);
      }

      const isFourUp = cardCount === 4;
      const cellW = isFourUp
        ? (n >= 4 ? 38 : (n === 3 ? 41 : 42))
        : (n >= 4 ? 30 : (n === 3 ? 34 : 41));
      const cellH = isFourUp
        ? (n >= 4 ? 30 : (n === 3 ? 32 : 34))
        : (n >= 4 ? 22 : (n === 3 ? 24 : 32));
      const cellFont = isFourUp
        ? (n >= 4 ? "1.18rem" : (n === 3 ? "1.3rem" : "1.36rem"))
        : (n >= 4 ? "0.94rem" : (n === 3 ? "1.05rem" : "1.28rem"));
      const minusFont = isFourUp
        ? (n >= 4 ? "1.22rem" : (n === 3 ? "1.35rem" : "1.42rem"))
        : (n >= 4 ? "1.05rem" : (n === 3 ? "1.2rem" : "1.48rem"));

      return `
        <div class="ld-table-wrap" style="--cell-w:${cellW}px;--cell-h:${cellH}px;--cell-font:${cellFont};--minus-font:${minusFont};">
          <table class="ld-table" aria-label="Long division workspace">
            <tbody>${rows.join("")}</tbody>
          </table>
        </div>
      `;
    }

    function renderProblemCard(problem, cfg, blankTemplate, cardCount, showRemainderBox) {
      return `
        <article class="problem-card">
          <div class="problem-main">
            <div class="multiples-panel">
              <div class="multiples-head">Multiples</div>
              <table class="multiples-table" aria-label="Multiples chart">
                <tbody>${multiplesRowsHtml(problem.divisor, els.multiplesMode.value, blankTemplate)}</tbody>
              </table>
            </div>

            <div class="problem-panel">
              ${longDivisionGridHtml(problem, cfg, blankTemplate, cardCount, showRemainderBox)}
            </div>
          </div>
        </article>
      `;
    }

    function renderWorksheet() {
      const cfg = getTypeConfig();
      const cardCount = getCardCount(cfg);
      const remainderMode = els.remainderMode.value;
      const source = buildProblems(cfg, cardCount, remainderMode);
      const blankTemplate = els.templateMode.value === "blank";
      const showRemainderBox = remainderMode !== "without";
      const title = (els.sheetTitle.value || "").trim() || "Long Division Practice Organizer";

      const modeNote = blankTemplate ? " Blank template mode on." : "";
      const remainderNote = remainderMode === "with"
        ? " Remainders."
        : (remainderMode === "mixed" ? " Mixed remainders." : " No remainders.");
      els.statusText.textContent = `${source.message}${modeNote}${remainderNote}`;
      els.statusText.style.color = "#000";

      if (!source.problems.length) {
        els.host.innerHTML = "";
        return;
      }

      const cards = source.problems.map((p) => (
        renderProblemCard(p, cfg, blankTemplate, cardCount, showRemainderBox)
      )).join("");
      const layoutClass = cardCount === 4 ? "layout-4" : "layout-6";

      els.host.innerHTML = `
        <section class="sheet ${layoutClass}">
          <header class="sheet-header">
            <h2 class="sheet-title">${title} (${cfg.label})</h2>
            <div class="name-line">Name:<span class="line"></span></div>
          </header>

          <section class="problem-grid">
            ${cards}
          </section>

          <div class="footer-note">Copyright - InterventionStation.com - @TeachwithMrC</div>
        </section>
      `;
    }

    els.generateBtn.addEventListener("click", renderWorksheet);
    els.typeButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        setProblemType(btn.dataset.type);
        renderWorksheet();
      });
    });
    els.problemMode.addEventListener("change", renderWorksheet);
    els.templateMode.addEventListener("change", renderWorksheet);
    els.remainderMode.addEventListener("change", renderWorksheet);
    els.multiplesMode.addEventListener("change", renderWorksheet);
    els.printBtn.addEventListener("click", () => window.print());

    setProblemType(els.problemType.value || "2x1");
    renderWorksheet();
  </script>
</body>
</html>
