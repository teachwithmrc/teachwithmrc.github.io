<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Picture Word Worksheet Generator</title>
  <script src="cvcLadderData.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    margin: 40px;
    text-align: center;
  }

  /* 1) New page margins */
  @page {
    size: letter;
    margin: 0.3in;
  }

  h1 {
    font-size: 26px;
    margin-bottom: 10px;
  }

  .subtitle {
    font-size: 16px;
    margin-bottom: 20px;
  }

  .table-section {
    border: 2px solid #000;
    padding: 5px;
    margin: 12px auto;
    width: fit-content;
    box-sizing: border-box;
  }

  .section-label {
    font-weight: 600;
    font-size: 18px;
    margin-bottom: 8px;
  }

  .skill-button-grid {
    display: flex;
    flex-direction: column;
    gap: 8px;
    justify-content: center;
  }

  .skill-button-grid .row {
    display: flex;
    justify-content: center;
    gap: 8px;
  }

  .skill-button {
    border: 2px solid #000;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
  }

  .skill-button.selected {
    background-color: #007bff;
    color: white;
    box-shadow: 0 0 4px rgba(0, 123, 255, 0.5);
  }

  #printableSection {
    margin-top: 20px;
  }

  #worksheetTitle {
    font-size: 16px;
    font-weight: bold;
    margin-bottom: 2px;
  }

  #worksheetDirections {
    font-size: 12px;
    margin-bottom: 4px;
  }

  table {
    margin: auto;
    border-collapse: collapse;
  }

  th, td {
    border: 1px solid #000;
    padding: 2px;
    text-align: center;
    vertical-align: middle;
    font-size: 13px;
  }

  td.picture-td {
    overflow: hidden;
    position: relative;
  }

  .picture-cell {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .picture-cell img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    display: block;
  }

  .write-cell {
    vertical-align: bottom;
    padding: 0;
  }

  .line-wrapper {
    display: flex;
    justify-content: center;
    gap: 3px;
    margin-bottom: 3px;
  }

  .letter-line {
    display: inline-block;
    border-bottom: 2px solid black;
    width: 34px;
  }

  #worksheetCopyright {
    font-size: 10px;
    text-align: right;
    margin-top: 6px;
    padding-right: 20px;
    visibility: hidden;
  }

  #answerKey {
    /* force answer key onto its own page */
    page-break-before: always;
    margin-top: 20px;
  }

  /* PRINT STYLES */
  @media print {
    /* hide UI chrome */
    body * {
      visibility: hidden !important;
    }
    /* show only our printable section */
    #printableSection,
    #printableSection * {
      visibility: visible !important;
    }

    /* shrink entire worksheet */
    #printableSection {
      position: absolute !important;
      top: 0; left: 0;
      width: 98% !important;
      margin: 0 auto !important;
      transform: scale(0.85) !important;
      transform-origin: top center;
      /* allow normal page-breaks */
    }

    /* allow breaking anywhere to fill page */
    .worksheet-content,
    .word-bank,
    table {
      page-break-inside: auto !important;
      break-inside: auto !important;
    }

    /* tighten Word Bank styling */
    .word-bank {
      border: 1px solid #000 !important;
      border-radius: 12px !important;
      padding: 1px 6px !important;
      margin: 4px auto 8px auto !important;
      font-size: 10px !important;
      text-align: center !important;
      width: auto !important;
    }

    /* shrink table text a touch */
    th, td {
      font-size: 11px !important;
    }

    table {
      width: 100% !important;
    }

    /* smaller picture cells */
    td.picture-td,
    .picture-cell {
      width: 160px !important;
      height: 90px !important;
    }

    .picture-cell img {
      max-width: 160px !important;
      max-height: 90px !important;
    }

    /* narrower letter lines */
    .letter-line {
      width: 28px !important;
    }

    /* pin the copyright */
    #worksheetCopyright {
      display: block !important;
      visibility: visible !important;
      position: fixed !important;
      bottom: 8px;
      right: 12px;
      font-size: 9px !important;
    }
  }
</style>
</head>
<body>
  <h1>Picture Word Worksheet Generator</h1>
  <div class="subtitle">Select a phonics skill, then generate a worksheet with matching pictures and writing lines.</div>

  <!-- Skill Selection -->
  <div class="table-section">
    <div class="section-label">Select Skills</div>
    <div class="skill-button-grid">
      <div class="row">
        <div class="skill-button" data-skill="0.1">Short A</div>
        <div class="skill-button" data-skill="0.2">Short O</div>
        <div class="skill-button" data-skill="0.3">Short I</div>
        <div class="skill-button" data-skill="0.4">Short U</div>
        <div class="skill-button" data-skill="0.5">Short E</div>
      </div>
      <div class="row">
        <div class="skill-button" data-skill="0.6">FLSZ</div>
        <div class="skill-button" data-skill="0.7">CVC & FLSZ</div>
        <div class="skill-button" data-skill="mixed">Mixed CVC</div>
      </div>
    </div>
  </div>

  <!-- Generate/Print Options -->
  <div class="table-section">
    <div class="section-label">Generate Worksheet</div>
    <button onclick="generatePictureWordTable()" style="font-size: 18px; padding: 10px 24px;">Generate</button>
    <button onclick="window.print()" style="font-size: 18px; padding: 10px 24px;">Print</button>
    <div style="margin-top: 8px;">
      <label style="font-size: 14px;">
        <input type="checkbox" id="includeWordBank"> Include Word Bank
      </label>
    </div>
  </div>

  <div id="printableSection">
    <div id="worksheetTitle"></div>
    <div id="worksheetDirections"></div>
  </div>

  <script>
    const selectedSkills = new Set();
    const skillLabels = {
      "0.1": "Short A", "0.2": "Short O", "0.3": "Short I",
      "0.4": "Short U", "0.5": "Short E", "0.6": "FLSZ",
      "0.7": "CVC & FLSZ", "mixed": "Mixed CVC"
    };

    document.querySelectorAll('.skill-button').forEach(button => {
      button.addEventListener('click', () => {
        const skill = button.dataset.skill;
        if (selectedSkills.has(skill)) {
          selectedSkills.delete(skill);
          button.classList.remove('selected');
        } else {
          selectedSkills.add(skill);
          button.classList.add('selected');
        }
      });
    });

    function generatePictureWordTable() {
      const container = document.getElementById('printableSection');
      container.innerHTML = '';

      // Skill Title + Directions
      const skillNames = [...selectedSkills].map(s => skillLabels[s] || s);
      const skillTitle = `${skillNames.join(', ')} Spelling`;
      const skillDirections = `Directions: Spell the word that matches the picture.`;

      // Prepare wrapper
      const contentWrapper = document.createElement('div');
      contentWrapper.className = 'worksheet-content';
      contentWrapper.style.pageBreakInside = 'avoid';
      contentWrapper.style.breakInside = 'avoid';

      // Title and directions
      contentWrapper.innerHTML = `
        <div id="worksheetTitle">${skillTitle}</div>
        <div id="worksheetDirections">${skillDirections}</div>
      `;

      // Generate 8 shuffled words
      const words = [...cvcLadderWords].sort(() => 0.5 - Math.random()).slice(0, 8);
      const includeBank = document.getElementById('includeWordBank').checked;

      // Adjust layout sizes based on word bank
      const tableWidth = includeBank ? 480 : 540;
      const maxImgWidth = includeBank ? 140 : 160;
      const maxImgHeight = includeBank ? 85 : 105;
      const letterLineWidth = includeBank ? 30 : 34;

      // Word Bank (if selected)
      if (includeBank) {
        const wordBank = document.createElement('div');
        wordBank.className = 'word-bank';
        wordBank.style.cssText = `
          border: 1px solid #000;
          border-radius: 12px;
          padding: 4px 12px;
          margin: 6px auto;
          width: ${tableWidth}px;
          text-align: center;
          page-break-inside: avoid;
        `;
        wordBank.innerHTML = `
          <div style="font-weight:bold; font-size:13px;">Word Bank:</div>
          <div style="font-size:12px; display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:2px;">
            ${[...words].sort(() => 0.5 - Math.random()).map(w => `<span style="font-weight:600;">${w}</span>`).join('')}
          </div>
        `;
        contentWrapper.appendChild(wordBank);
      }

      // Main Table
      const table = document.createElement('table');
      table.style.width = tableWidth + 'px';
      table.style.pageBreakInside = 'avoid';
      table.innerHTML = `
        <tr><th>No.</th><th>Picture</th><th>Write the Word</th></tr>
      `;

      words.forEach((word, i) => {
        const lines = `<div class="line-wrapper">${'<span class="letter-line" style="width:'+letterLineWidth+'px;"></span>'.repeat(word.length)}</div>`;
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${i+1}</td>
          <td class="picture-td" style="width:${maxImgWidth}px; height:${maxImgHeight}px;">
            <div class="picture-cell" style="width:${maxImgWidth}px; height:${maxImgHeight}px;">
              <img src="${cvcLadderImages[word] || ''}" alt="${word}">
            </div>
          </td>
          <td class="write-cell" style="height:${maxImgHeight}px;">${lines}</td>
        `;
        table.appendChild(row);
      });

      contentWrapper.appendChild(table);

      // Copyright
      const copyright = document.createElement('div');
      copyright.id = 'worksheetCopyright';
      copyright.textContent = '© 2025 Intervention Station – TeachWithMrC';
      contentWrapper.appendChild(copyright);

      // Append everything to container
      container.appendChild(contentWrapper);

      // Answer Key
      const answerKey = document.createElement('div');
      answerKey.id = 'answerKey';
      answerKey.style.pageBreakBefore = 'always';
      answerKey.innerHTML = `
        <div style="font-weight:bold; margin-bottom:8px; font-size:16px;">${skillTitle} – Answer Key</div>
        <table style="width:${tableWidth}px;">
          <tr><th>No.</th><th>Picture</th><th>Answer</th></tr>
          ${words.map((word,i) => `
            <tr>
              <td>${i+1}</td>
              <td class="picture-td" style="width:${maxImgWidth}px; height:${maxImgHeight}px;">
                <div class="picture-cell" style="width:${maxImgWidth}px; height:${maxImgHeight}px;">
                  <img src="${cvcLadderImages[word] || ''}" alt="${word}">
                </div>
              </td>
              <td style="font-weight:600;">${word}</td>
            </tr>
          `).join('')}
        </table>
      `;
      container.appendChild(answerKey);
    }
  </script>
</body>
</html>
