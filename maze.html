<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fluency Grid Generator</title>
  <script src="fluencyDataFull_v3.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 40px;
      text-align: center;
    }
    h1 { font-size: 26px; margin-bottom: 10px; }
    .subtitle { font-size: 16px; margin-bottom: 30px; }
    .table-section {
      border: 2px solid #000;
      padding: 20px;
      margin: 12px auto;
      width: fit-content;
      box-sizing: border-box;
    }
    .section-label { font-weight: 600; font-size: 18px; margin-bottom: 12px; }
    .skill-button-grid { display: flex; flex-direction: column; gap: 8px; justify-content: center; }
    .skill-button-grid .row { display: flex; justify-content: center; gap: 8px; margin-bottom: 6px; }
    .skill-button {
      border: 2px solid #000;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
    }
    .skill-button.selected { background-color: #007bff; color: white; box-shadow: 0 0 4px rgba(0, 123, 255, 0.5); }
    .option-grid { display: flex; justify-content: center; flex-wrap: wrap; gap: 12px; margin-top: 10px; }
    .option-box {
      padding: 10px 14px;
      border: 2px solid #000;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }
    .option-box.selected-step2 { background-color: #d9c9ff; }
    .option-box.selected-step3 { background-color: #d0f0ff; }
    .option-box input { display: none; }
    table { margin: auto; border-collapse: collapse; }
    td {
      border: 1px solid #000;
      width: 120px;
      height: 80px;
      font-size: 32px;
      text-align: center;
      vertical-align: middle;
    }
    .copyright { text-align: center; font-size: 12px; margin-top: 60px; }
    @media print {
      body * { visibility: hidden; }
      #printableSection, #printableSection * { visibility: visible; }
      #printableSection {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>CVC and FLSZ Maze Grid Generator</h1>
  <div class="subtitle">
    Directions: Follow the path of different target words. All other squares are traps!
  </div>
  <div class="table-section">
    <div class="section-label">Step 1: Select Skill</div>
    <div class="skill-button-grid">
      <div class="row">
        <div class="skill-button" data-skill="0.1">Short A</div>
        <div class="skill-button" data-skill="0.2">Short O</div>
        <div class="skill-button" data-skill="0.3">Short I</div>
        <div class="skill-button" data-skill="0.4">Short U</div>
        <div class="skill-button" data-skill="0.5">Short E</div>
      </div>
    </div>
  </div>
  <div style="margin-top: 30px;">
    <button onclick="generateMazeGrids()" style="font-size: 18px; padding: 10px 24px;">Generate Maze Grids</button>
    <button onclick="window.print()" style="font-size: 18px; padding: 10px 24px;">Print</button>
  </div>
  <div id="printableSection">
    <div id="gridContainer"></div><br><br><br>
    <div class="copyright">Copyright - InterventionStation.com - @TeachwithMrC</div>
  </div>
  <script>
    const selectedSkills = new Set();
    document.querySelectorAll('.skill-button').forEach(button => {
      button.addEventListener('click', () => {
        const skill = button.dataset.skill;
        if (selectedSkills.has(skill)) {
          selectedSkills.delete(skill);
          button.classList.remove('selected');
        } else {
          selectedSkills.clear();
          document.querySelectorAll('.skill-button').forEach(btn => btn.classList.remove('selected'));
          selectedSkills.add(skill);
          button.classList.add('selected');
        }
      });
    });

    const allShortSkills = ["0.1", "0.2", "0.3", "0.4", "0.5"];

    const pathPatterns = [
      [[0,0],[0,1],[1,1],[1,2],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[1,1],[2,1],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[2,0],[2,1],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[1,1],[2,1],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[2,0],[2,1],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[1,1],[1,2],[2,2],[3,2],[4,2]],
      [[0,0],[0,1],[0,2],[1,2],[2,2],[3,2],[4,2]],
      [[0,0],[1,0],[2,0],[3,0],[3,1],[4,1],[4,2]],
      [[0,0],[1,0],[2,0],[3,0],[4,0],[4,1],[4,2]],
      [[0,0],[0,1],[1,1],[2,1],[3,1],[4,1],[4,2]]
    ];

    function generateMazeGrids() {
      const skill = [...selectedSkills][0];
      if (!skill) return alert("Select one skill.");
      const targetWords = [...(fluencyData.words[`${skill} - ${getSkillLabel(skill)} Words`] || [])];
      if (targetWords.length < 7) return alert("Need at least 7 target words.");
      const otherWords = allShortSkills.filter(s => s !== skill).flatMap(s => fluencyData.words[`${s} - ${getSkillLabel(s)} Words`] || []);
      const container = document.getElementById("gridContainer");
      container.innerHTML = "";
      for (let m = 0; m < 2; m++) {
        const path = pathPatterns[Math.floor(Math.random() * pathPatterns.length)];
        const pathWords = [...targetWords].sort(() => 0.5 - Math.random()).slice(0, path.length);
        const grid = Array.from({ length: 5 }, () => Array(5).fill(""));
        path.forEach((pos, idx) => { grid[pos[0]][pos[1]] = pathWords[idx]; });
        for (let r = 0; r < 5; r++) {
          for (let c = 0; c < 5; c++) {
            if (!grid[r][c]) {
              let word;
              do { word = otherWords[Math.floor(Math.random() * otherWords.length)]; }
              while (targetWords.includes(word));
              grid[r][c] = word;
            }
          }
        }
        let html = "<table>" + grid.map(row => `<tr>${row.map(w => `<td>${w}</td>`).join('')}</tr>`).join('') + "</table><br><br>";
        container.innerHTML += html;
      }
    }

    function getSkillLabel(skill) {
      return skill === "0.1" ? "Short A" : skill === "0.2" ? "Short O" : skill === "0.3" ? "Short I" : skill === "0.4" ? "Short U" : "Short E";
    }
  </script>
</body>
</html>
