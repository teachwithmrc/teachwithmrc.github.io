<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Open Number Line – Count Backwards (Tens and Ones)</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding: 20px;
      display: flex;
      justify-content: center;
      background: #f5f5f5;
    }

    .container {
      background: #ffffff;
      padding: 20px 24px 28px;
      border-radius: 12px;
      max-width: 900px;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    h1 {
      font-size: 1.4rem;
      margin: 0 0 8px;
      text-align: center;
    }

    .subtitle {
      font-size: 0.9rem;
      text-align: center;
      margin-bottom: 14px;
      color: #555;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }

    label {
      font-size: 0.9rem;
    }

    input {
      width: 70px;
      padding: 4px 6px;
      font-size: 0.9rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    button {
      padding: 6px 12px;
      font-size: 0.9rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      background: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }

    button:hover {
      transform: translateY(-1px);
    }

    svg {
      border: 2px solid #000;
      border-radius: 8px;
      background: #fff;
      width: 100%;
      height: 240px;
      margin-top: 10px;
    }

    .equation {
      text-align: center;
      font-size: 1.4rem;
      margin-top: 10px;
      font-weight: 600;
    }

    .footer-note {
      font-size: 0.8rem;
      color: #555;
      margin-top: 8px;
      text-align: center;
    }

    .warning {
      text-align: center;
      color: #b00020;
      font-size: 0.9rem;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Open Number Line – Count Backwards</h1>
    <div class="subtitle">
      Start at the number on the right. Hop back by ones, then tens. Students fill in the blanks under each tick.
    </div>

    <div class="controls">
      <label>Start:</label>
      <input id="startInput" type="number" value="72" />
      <label>Subtract:</label>
      <input id="subInput" type="number" value="38" />
      <button id="drawBtn">Draw Number Line</button>
    </div>

    <svg id="numberLineSvg" viewBox="0 0 800 240"></svg>

    <div id="equation" class="equation"></div>
    <div id="warning" class="warning"></div>

    <div class="footer-note">
      Example: 72 − 38 → eight small −1 hops (students write 71, 70, 69, …), then three big −10 hops.
    </div>
  </div>

  <script>
    const svg = document.getElementById("numberLineSvg");
    const eqEl = document.getElementById("equation");
    const warnEl = document.getElementById("warning");

    function clearSvg() {
      while (svg.firstChild) svg.removeChild(svg.firstChild);
    }

    function createSvgElement(name, attrs) {
      const el = document.createElementNS("http://www.w3.org/2000/svg", name);
      for (const key in attrs) {
        el.setAttribute(key, attrs[key]);
      }
      return el;
    }

    function drawNumberLine(start, sub) {
      clearSvg();
      eqEl.textContent = "";
      warnEl.textContent = "";

      if (!Number.isFinite(start) || !Number.isFinite(sub)) {
        warnEl.textContent = "Enter valid numbers.";
        return;
      }
      if (sub <= 0 || start <= sub) {
        warnEl.textContent = "Use numbers with start > subtract and subtract > 0.";
        return;
      }

      // Decompose subtrahend: ones first, then tens (e.g., 38 -> 8 ones, 3 tens)
      const ones = sub % 10;
      const tens = Math.floor(sub / 10);

      const steps = [];
      for (let i = 0; i < ones; i++) steps.push(1);
      for (let i = 0; i < tens; i++) steps.push(10);

      const segmentCount = steps.length;
      if (segmentCount === 0) return;

      // Compute values from right (start) to left (answer)
      const points = [];
      let currentVal = start;
      points.push({ value: currentVal }); // start label (right)

      for (const step of steps) {
        currentVal -= step;
        points.push({ value: currentVal });
      }
      const answer = currentVal;

      // Layout with proportional spacing
      const svgWidth = 800;
      const marginLeft = 80;
      const marginRight = 80;
      const arrowGap = 16; // space between line arrow and first/last tick
      const lineY = 150;

      const xLineStart = marginLeft;
      const xLineEnd = svgWidth - marginRight;
      const innerStart = xLineStart + arrowGap;
      const innerEnd = xLineEnd - arrowGap;
      const innerLength = innerEnd - innerStart;

      const totalDistance = steps.reduce((a, b) => a + b, 0);
      const widthPerUnit = innerLength / totalDistance;

      // positions: start at right innerEnd, walk left by proportional distances
      let xCurrent = innerEnd;
      points[0].x = xCurrent;

      let stepIndex = 0;
      for (let i = 1; i < points.length; i++) {
        const stepSize = steps[stepIndex++];
        xCurrent -= stepSize * widthPerUnit;
        points[i].x = xCurrent;
      }

      const xStartTick = points[0].x;
      const xEndTick = points[points.length - 1].x;

      // main line
      const mainLine = createSvgElement("line", {
        x1: xLineStart,
        y1: lineY,
        x2: xLineEnd,
        y2: lineY,
        stroke: "black",
        "stroke-width": 5,
        "stroke-linecap": "round"
      });
      svg.appendChild(mainLine);

      // arrowheads OUTSIDE the ticks
      const leftArrow = createSvgElement("path", {
        d: `M ${xLineStart} ${lineY} L ${xLineStart + 14} ${lineY - 8} L ${xLineStart + 14} ${lineY + 8} Z`,
        fill: "black"
      });
      const rightArrow = createSvgElement("path", {
        d: `M ${xLineEnd} ${lineY} L ${xLineEnd - 14} ${lineY - 8} L ${xLineEnd - 14} ${lineY + 8} Z`,
        fill: "black"
      });
      svg.appendChild(leftArrow);
      svg.appendChild(rightArrow);

      // ticks + labels (only start number; others are blanks)
      points.forEach((pt, i) => {
        const tick = createSvgElement("line", {
          x1: pt.x,
          y1: lineY - 12,
          x2: pt.x,
          y2: lineY + 12,
          stroke: "black",
          "stroke-width": 3
        });
        svg.appendChild(tick);

        const label = createSvgElement("text", {
          x: pt.x,
          y: lineY + 34,
          "text-anchor": "middle",
          "font-size": "18",
          "font-weight": i === 0 ? "700" : "400"
        });

        if (i === 0) {
          // Only show the starting number (rightmost tick)
          label.textContent = pt.value;
        } else {
          // Blank line for students to fill in (e.g., 71, 70, 69, …)
          label.textContent = "_____";
        }

        svg.appendChild(label);
      });

      // arcs + jump labels (−1 vs −10)
      for (let i = 0; i < steps.length; i++) {
        const stepSize = steps[i];
        const x1 = points[i].x;
        const x2 = points[i + 1].x;
        const midX = (x1 + x2) / 2;

        // higher arc for tens than ones
        const arcHeight = stepSize === 1 ? 26 : 42;

        const path = createSvgElement("path", {
          d: `M ${x1} ${lineY} Q ${midX} ${lineY - arcHeight}, ${x2} ${lineY}`,
          fill: "none",
          stroke: "black",
          "stroke-width": 4,
          "stroke-linecap": "round"
        });
        svg.appendChild(path);

        const jumpLabel = createSvgElement("text", {
          x: midX,
          y: lineY - arcHeight - 6,
          "text-anchor": "middle",
          "font-size": "16",
          "font-weight": "700"
        });
        jumpLabel.textContent = `-${stepSize}`;
        svg.appendChild(jumpLabel);
      }

      // equation with blank answer (students solve)
      eqEl.textContent = `${start} − ${sub} = ?   (answer: ${answer})`;
      // If you don't want the answer given at all, delete " (answer: ...)" above.
    }

    document.getElementById("drawBtn").addEventListener("click", () => {
      const start = parseInt(document.getElementById("startInput").value, 10);
      const sub = parseInt(document.getElementById("subInput").value, 10);
      drawNumberLine(start, sub);
    });

    // initial example
    drawNumberLine(72, 38);
  </script>
</body>
</html>
